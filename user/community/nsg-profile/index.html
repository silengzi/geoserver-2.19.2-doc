<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>NSG Profile &mdash; GeoServer 2.19.2 User Manual</title>
  <link rel="stylesheet" href="../../static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.19.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../static/jquery.js"></script>
  <script type="text/javascript" src="../../static/doctools.js"></script>
  <script type="text/javascript" src="../../static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
  <link rel="shortcut icon" href="../../static/geoserver.ico"/>
      <link rel="search" title="Search" href="../../search.html" />
      <link rel="top" title="GeoServer 2.19.2 User Manual" href="../../index.html" />
      <link rel="up" title="Community modules" href="../index.html" />
      <link rel="next" title="GHRSST NetCDF output" href="../netcdf-ghrsst/index.html" />
      <link rel="prev" title="S3 Support for GeoTiff" href="../s3-geotiff/index.html" />
</head>
<body class="community/nsg-profile/index">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.19.2 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/about">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/download">Download</a></li>
        <!--<li><a href="../../index.html">Documentation</a></li>-->
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content-left" class="content-border"></div>
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.19.2 User Manual</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Community modules</a> &raquo;</li>
  <li>NSG Profile</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../../py-modindex.html" title="Python Module Index"
       accesskey="">modules</a></li>
  <li>
    <a href="../netcdf-ghrsst/index.html" title="GHRSST NetCDF output"
       accesskey="N">next</a>|</li>
  <li>
    <a href="../s3-geotiff/index.html" title="S3 Support for GeoTiff"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="nsg-profile">
<span id="community-nsg-profile"></span><h1>NSG Profile<a class="headerlink" href="#nsg-profile" title="Permalink to this headline">¶</a></h1>
<p>NSG Profile introduces a new operation for WFS 2.0.2 named PageResults. This operation will allow clients to access paginated results using random positions.</p>
<p>The current WFS 2.0.2 OGC specification defines a basic pagination support that can been used to navigate through features responses results.</p>
<p>Pagination is activated when parameters count and startIndex are used in the query, for example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://&lt;host&gt;/geoserver/ows?service=WFS&amp;version=2.0.0&amp;request=GetFeature&amp;typeNames=topp%3Atasmania_roads&amp;count=5&amp;startIndex=0
</pre></div>
</div>
</div></blockquote>
<p>In this case each page will contain five features.
The returned feature collection will have the next and previous attributes which will contain an URL that will allow clients to navigate through the results pages, i.e. previous page and next page:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">wfs</span><span class="p">:</span><span class="n">FeatureCollection</span>
   <span class="n">previous</span><span class="o">=</span><span class="s2">&quot;http://localhost:8080/geoserver/wfs?</span>
   <span class="n">REQUEST</span><span class="o">=</span><span class="n">GetFeature</span><span class="o">&amp;</span>
   <span class="n">VERSION</span><span class="o">=</span><span class="mf">2.0</span><span class="o">.</span><span class="mi">0</span><span class="o">&amp;</span>
   <span class="n">TYPENAMES</span><span class="o">=</span><span class="n">topp</span><span class="p">:</span><span class="n">tasmania_roads</span><span class="o">&amp;</span>
   <span class="n">SERVICE</span><span class="o">=</span><span class="n">WFS</span><span class="o">&amp;</span>
   <span class="n">COUNT</span><span class="o">=</span><span class="mi">2</span><span class="o">&amp;</span>
   <span class="n">STARTINDEX</span><span class="o">=</span><span class="mi">0</span><span class="s2">&quot;</span>
   <span class="nb">next</span><span class="o">=</span><span class="s2">&quot;http://localhost:8080/geoserver/wfs?</span>
   <span class="n">REQUEST</span><span class="o">=</span><span class="n">GetFeature</span><span class="o">&amp;</span>
   <span class="n">VERSION</span><span class="o">=</span><span class="mf">2.0</span><span class="o">.</span><span class="mi">0</span><span class="o">&amp;</span>
   <span class="n">TYPENAMES</span><span class="o">=</span><span class="n">topp</span><span class="p">:</span><span class="n">tasmania_roads</span><span class="o">&amp;</span>
   <span class="n">SERVICE</span><span class="o">=</span><span class="n">WFS</span><span class="o">&amp;</span>
   <span class="n">COUNT</span><span class="o">=</span><span class="mi">2</span><span class="o">&amp;</span>
   <span class="n">STARTINDEX</span><span class="o">=</span><span class="mi">4</span><span class="s2">&quot;</span>
   <span class="n">numberMatched</span><span class="o">=</span><span class="s2">&quot;14&quot;</span>
   <span class="n">numberReturned</span><span class="o">=</span><span class="s2">&quot;2&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>This means that this type of navigation will always be sequential, if the client is showing page two and the user wants to see page five the client will have to:</p>
<ol class="arabic simple">
<li><p>request page three and use the provided next URL to retrieve page four</p></li>
<li><p>request page four and use the provided next URI to retrieve page five</p></li>
</ol>
<p>This is not an ideal solution to access random pages, which is common action.
PageResults operation adds a standard way to perform request random pages directly.</p>
<div class="section" id="installing-the-extension">
<h2>Installing the extension<a class="headerlink" href="#installing-the-extension" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Download the NSG Profile extension from the nightly GeoServer community module builds.</p></li>
<li><p>Place the JARs into the <code class="docutils literal notranslate"><span class="pre">WEB-INF/lib</span></code> directory of the GeoServer installation.</p></li>
</ol>
</div>
<div class="section" id="configure-the-extension">
<h2>Configure the extension<a class="headerlink" href="#configure-the-extension" title="Permalink to this headline">¶</a></h2>
<p>The root directory inside the GeoServer data directory for the nsg-profile community module is named nsg-profile and all the configurations properties are stored in a file named <strong>configuration.properties</strong>.</p>
<p>All configuration properties are changeable at runtime, which means that if a property is updated the module take it into account.</p>
<p>When the application starts if no configuration file exists one with the default values is created.</p>
<p>The GetFeature requests representations associated with an index result type is serialized and stored in the file system in a location that is configurable.</p>
<p>The default location, relative to the GeoServer data directory, is nsg-profie/resultSets.</p>
<p>The GetFeature request to resultSetID mapping is stored by default in an H2 DB in nsg-profie/resultSets folder; for details on database configuration see <a class="reference external" href="https://docs.geotools.org/latest/userguide/library/jdbc/datastore.html">GeoTools JDBCDataStore syntax</a>.</p>
<p>The configuration properties are the follows:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>resultSets.storage.path</p></td>
<td><p>${GEOSERVER_DATA_DIR}/nsg-profile/resultSets</p></td>
<td><p>Path where to store GetFeature requests representations</p></td>
</tr>
<tr class="row-odd"><td><p>resultSets.timeToLive</p></td>
<td><p>600</p></td>
<td><p>How long a GetFeature request should be maintained by the server (in seconds)</p></td>
</tr>
<tr class="row-even"><td><p>resultSets.db.dbtype</p></td>
<td><p>h2</p></td>
<td><p>DB type used to store GetFeature request to resultSetID mapping</p></td>
</tr>
<tr class="row-odd"><td><p>resultSets.db.database</p></td>
<td><p>${GEOSERVER_DATA_DIR}/nsg-profile/db/resultSets</p></td>
<td><p>path where to store GetFeature request to resultSetID mapping</p></td>
</tr>
<tr class="row-even"><td><p>resultSets.db.user</p></td>
<td><p>sa</p></td>
<td><p>database user username</p></td>
</tr>
<tr class="row-odd"><td><p>resultSets.db.password</p></td>
<td><p>sa</p></td>
<td><p>database user password</p></td>
</tr>
<tr class="row-even"><td><p>resultSets.db.port</p></td>
<td></td>
<td><p>database port to connect to</p></td>
</tr>
<tr class="row-odd"><td><p>resultSets.db.schema</p></td>
<td></td>
<td><p>database schema</p></td>
</tr>
<tr class="row-even"><td><p>resultSets.db.host</p></td>
<td></td>
<td><p>server to connect to</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="index-result-type">
<h2>Index Result Type<a class="headerlink" href="#index-result-type" title="Permalink to this headline">¶</a></h2>
<p>The <strong>index result type</strong> extends the WFS <strong>hits result type</strong> by adding an extra attribute named <strong>resultSetID</strong> to the response.
The <strong>resultSetID</strong> attribute can then be used by the <strong>PageResults operation</strong> to navigate randomly through the results.</p>
<p>A GetFeature request that uses the index result type should look like this:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://&lt;host&gt;/geoserver/ows?service=WFS&amp;version=2.0.0&amp;request=GetFeature&amp;typeNames=topp%3Atasmania_roads&amp;resultType=index
</pre></div>
</div>
</div></blockquote>
<p>The response of a GetFeature operation when the index result type is used should look like this:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;wfs:FeatureCollection
 numberMatched=&quot;14&quot;
 numberReturned=&quot;0&quot;
 resultSetID=&quot;ef35292477a011e7b5a5be2e44b06b34&quot;
 xmlns:fes=&quot;http://www.opengis.net/fes/2.0&quot;
 xmlns:gml=&quot;http://www.opengis.net/gml/3.2&quot;
 xmlns:ows=&quot;http://www.opengis.net/ows/1.1&quot;
 xmlns:wfs=&quot;http://www.opengis.net/wfs/2.0&quot;
 xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;
 xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;
 xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
 xsi:schemaLocation=&quot;http://www.opengis.net/wfs/2.0
 http://schemas.opengis.net/wfs/2.0/wfs.xsd&quot;/&gt;
</pre></div>
</div>
</div></blockquote>
<p>The <strong>resultSetID</strong> is an unique identifier that identifies the original request.</p>
<p>Clients will use the <strong>resultSetID</strong> with the PageResults operation to reference the original request.</p>
<p>If pagination is used, the previous and next attributes should appear as in hits result type request.</p>
</div>
<div class="section" id="pageresults-operation">
<h2>PageResults Operation<a class="headerlink" href="#pageresults-operation" title="Permalink to this headline">¶</a></h2>
<p>The <strong>PageResults operation</strong> allows clients to query random positions of an existing result set (stored GetFeature request) that was previously created using the <strong>index result type</strong> request.</p>
<p>The available parameters are this ones:</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 20%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Mandatory</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>service</p></td>
<td><p>YES</p></td>
<td><p>WFS</p></td>
</tr>
<tr class="row-odd"><td><p>version</p></td>
<td><p>YES</p></td>
<td><p>2.0.2</p></td>
</tr>
<tr class="row-even"><td><p>request</p></td>
<td><p>YES</p></td>
<td><p>PageResults</p></td>
</tr>
<tr class="row-odd"><td><p>resultSetID</p></td>
<td><p>YES</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>startIndex</p></td>
<td><p>NO</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>count</p></td>
<td><p>NO</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>outputFormat</p></td>
<td><p>NO</p></td>
<td><p>application/gml+xml; version=3.2</p></td>
</tr>
<tr class="row-odd"><td><p>resultType</p></td>
<td><p>NO</p></td>
<td><p>results</p></td>
</tr>
<tr class="row-even"><td><p>timeout</p></td>
<td><p>NO</p></td>
<td><p>300</p></td>
</tr>
</tbody>
</table>
<p>The two parameters that are not already supported by the GetFeature operation are the <strong>resultSetID</strong> parameter and the <strong>timeout</strong> parameter.</p>
<ol class="arabic">
<li><p>The <strong>resultSetID</strong> parameter should reference an existing result set (stored GetFeature request).</p>
<p>A typical PageResults request will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://&lt;host&gt;/geoserver/ows?service=WFS&amp;version=2.0.2&amp;request=PageResults&amp;resultSetID=ef35292477a011e7b5a5be2e44b06b34&amp;startIndex=5&amp;count=10&amp;outputFormat=application/gml+xml; version=3.2&amp;resultType=results
</pre></div>
</div>
<p>This looks like a GetFeature request where the <strong>query expression was substituted by the resultSetID parameter</strong>.</p>
</li>
<li><p>The <strong>timeout</strong> parameter is not implemented yet.</p></li>
</ol>
<p>The following parameters of index request are override using the ones provided with the PageResults operation or the default values:</p>
<ol class="arabic simple">
<li><p>startIndex</p></li>
<li><p>count</p></li>
<li><p>outputFormat</p></li>
<li><p>resultType</p></li>
</ol>
<p>and finally the GetFeature response is returned.</p>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="../s3-geotiff/index.html" title="previous chapter">S3 Support for GeoTiff</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../netcdf-ghrsst/index.html" title="next chapter">GHRSST NetCDF output</a></div>
      </div>
      </div><!-- /#content> -->
      <div id="content-right" class="content-border"></div>
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">NSG Profile</a><ul>
<li><a class="reference internal" href="#installing-the-extension">Installing the extension</a></li>
<li><a class="reference internal" href="#configure-the-extension">Configure the extension</a></li>
<li><a class="reference internal" href="#index-result-type">Index Result Type</a></li>
<li><a class="reference internal" href="#pageresults-operation">PageResults Operation</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="../s3-geotiff/index.html" title="previous chapter">S3 Support for GeoTiff</a></li>
            <li>Next: <a href="../netcdf-ghrsst/index.html" title="next chapter">GHRSST NetCDF output</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
                
        <li><a href="https://github.com/geoserver/geoserver/tree/master/doc/en/user/source/community/nsg-profile/index.rst">Edit</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2021, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Jul 20, 2021.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>