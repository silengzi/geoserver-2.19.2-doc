<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Usage Via GeoServer’s REST API &mdash; GeoServer 2.19.2 User Manual</title>
  <link rel="stylesheet" href="../../static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.19.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../static/jquery.js"></script>
  <script type="text/javascript" src="../../static/doctools.js"></script>
  <script type="text/javascript" src="../../static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
  <link rel="shortcut icon" href="../../static/geoserver.ico"/>
      <link rel="search" title="Search" href="../../search.html" />
      <link rel="top" title="GeoServer 2.19.2 User Manual" href="../../index.html" />
      <link rel="up" title="Backup and Restore Documentation" href="index.html" />
      <link rel="next" title="Backup and Restore Extension for the management of ImageMosaic indexers" href="extensions.html" />
      <link rel="prev" title="Usage Via GeoServer’s User Interface" href="usagegui.html" />
</head>
<body class="community/backuprestore/usagerest">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.19.2 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/about">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/download">Download</a></li>
        <!--<li><a href="../../index.html">Documentation</a></li>-->
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content-left" class="content-border"></div>
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.19.2 User Manual</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Community modules</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Backup and Restore Documentation</a> &raquo;</li>
  <li>Usage Via GeoServer’s REST API</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../../py-modindex.html" title="Python Module Index"
       accesskey="">modules</a></li>
  <li>
    <a href="extensions.html" title="Backup and Restore Extension for the management of ImageMosaic indexers"
       accesskey="N">next</a>|</li>
  <li>
    <a href="usagegui.html" title="Usage Via GeoServer’s User Interface"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="usage-via-geoserver-s-rest-api">
<span id="backup-restore-usagerest"></span><h1>Usage Via GeoServer’s REST API<a class="headerlink" href="#usage-via-geoserver-s-rest-api" title="Permalink to this headline">¶</a></h1>
<p>The Backup and Restore REST api consists of a few resources meant to used in an asynchronous fashion:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Resource</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Parameters and Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>/rest/br/backup/</p></td>
<td><p>POST</p></td>
<td><p>Post a JSON/XML document with the backup parameters, see below</p></td>
</tr>
<tr class="row-odd"><td><p>/rest/br/backup/backupId</p></td>
<td><p>GET</p></td>
<td><p>Returns a json/xml representation of the backup operation. See below</p></td>
</tr>
<tr class="row-even"><td><p>/rest/br/backup/backupId</p></td>
<td><p>DELETE</p></td>
<td><p>Cancels the backup operation</p></td>
</tr>
<tr class="row-odd"><td><p>/rest/br/restore</p></td>
<td><p>POST</p></td>
<td><p>Post a JSON/XML document with the restore parameters, see below</p></td>
</tr>
<tr class="row-even"><td><p>/rest/br/restore/restoreId</p></td>
<td><p>GET</p></td>
<td><p>Returns a json/xml representation of the backup operation, see below</p></td>
</tr>
<tr class="row-odd"><td><p>/rest/br/restore/restoreId</p></td>
<td><p>DELETE</p></td>
<td><p>Cancels the restore operation</p></td>
</tr>
</tbody>
</table>
<div class="section" id="usage-example">
<h2>Usage Example<a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<p>We are going to use the command line tool cURL to send HTTP REST requests to GeoServer.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">/rest/br/backup/</span></code> and <code class="docutils literal notranslate"><span class="pre">/rest/br/restore</span></code> endpoints accept an optional format suffix that allows the Backup / Restore archive to be streamed to / from the client instead of being written on / read from the file system.</p>
<p><strong>Initiate a Backup</strong></p>
<p>Prepare a file containing with a JSON object representing the Backup procedure configuration.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">backup_post.json</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;backup&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;archiveFile&quot;</span><span class="p">:</span><span class="s2">&quot;/home/sg/BackupAndRestore/test_rest_1.zip&quot;</span><span class="p">,</span>
      <span class="s2">&quot;overwrite&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>In this case we did not specify any options in the backup configuration so default values will be used.</p>
<p>Available options are:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BK_BEST_EFFORT</span></code>: Skip any failing resources and proceed with the backup procedure. Default: <cite>false</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_PARAM_PASSWORDS</span></code>: Whether outgoing store passwords should be parameterized in the backup. With this option set
all store passwords will be replaced with a token that looks like <cite>${workspaceName:storeName.passwd.encryptedValue}</cite>.
See also <code class="docutils literal notranslate"><span class="pre">BK_PASSWORD_TOKENS</span></code> for the Restore command.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_SKIP_SECURITY</span></code>: This will exclude security settings from the backup. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_SKIP_SETTINGS</span></code>: This will attempt to exclude global settings from the backup, as well as security settings. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_SKIP_GWC</span></code>: This option will avoid backup / restore the GWC catalog and folders. Default: <cite>false</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_CLEANUP_TEMP</span></code>: This will attempt to delete temporary folder at the end of the execution. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exclude.file.path</span></code>: A <code class="docutils literal notranslate"><span class="pre">;</span></code> separated list of paths relative to the <code class="docutils literal notranslate"><span class="pre">GEOSERVER_DATA_DIR</span></code>
(e.g.: ‘exclude.file.path=/data/geonode;/monitoring;/geofence’). If exist, the backup / restore will skip the path listed. Default: <cite>[]</cite>.
WARNING: <code class="docutils literal notranslate"><span class="pre">security</span></code> and <code class="docutils literal notranslate"><span class="pre">workspaces</span></code> are threated differently. This option should be used only for custom external resources located under the <code class="docutils literal notranslate"><span class="pre">GEOSERVER_DATA_DIR</span></code>.</p></li>
</ol>
<p>Also an optional <code class="docutils literal notranslate"><span class="pre">Filter</span></code> can be passed to restrict the scope of the restore operation to a list of workspaces.</p>
<blockquote>
<div><p>For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;backup&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;archiveFile&quot;</span><span class="p">:</span><span class="s2">&quot;/home/sg/BackupAndRestore/test_rest_1.zip&quot;</span><span class="p">,</span>
<span class="s2">&quot;overwrite&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;BK_BEST_EFFORT=true&quot;</span><span class="p">]</span>
      <span class="p">},</span>
<span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="s2">&quot;name IN (&#39;topp&#39;,&#39;geosolutions-it&#39;)&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Backup procedure will be initiated.</p>
<blockquote>
<div><p>Here is a sample response</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">201</span> <span class="n">Created</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Mon</span><span class="p">,</span> <span class="mi">01</span> <span class="n">Aug</span> <span class="mi">2016</span> <span class="mi">14</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="mi">44</span> <span class="n">GMT</span>
<span class="n">Location</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mygeoserver</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">br</span><span class="o">/</span><span class="n">backup</span><span class="o">/</span><span class="mi">1</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">Noelios</span><span class="o">-</span><span class="n">Restlet</span><span class="o">-</span><span class="n">Engine</span><span class="o">/</span><span class="mf">1.0</span><span class="o">..</span><span class="mi">8</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Transfer</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="n">chunked</span>

<span class="p">{</span>
   <span class="s2">&quot;backup&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;totalNumberOfSteps&quot;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span>
      <span class="s2">&quot;execution&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
         <span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
         <span class="s2">&quot;stepExecutions&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;java.util.concurrent.CopyOnWriteArraySet&quot;</span>
         <span class="p">},</span>
         <span class="s2">&quot;status&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;STARTED&quot;</span>
         <span class="p">],</span>
         <span class="s2">&quot;startTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 14:35:44.802 UTC&quot;</span><span class="p">,</span>
         <span class="s2">&quot;createTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 14:35:44.798 UTC&quot;</span><span class="p">,</span>
         <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 14:35:44.803 UTC&quot;</span><span class="p">,</span>
         <span class="s2">&quot;exitStatus&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;exitCode&quot;</span><span class="p">:</span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exitDescription&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
         <span class="p">},</span>
         <span class="s2">&quot;progress&quot;</span><span class="p">:</span><span class="s2">&quot;1\/9&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;synchList&quot;</span><span class="p">,</span>
         <span class="s2">&quot;option&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;OVERWRITE=true&quot;</span>
         <span class="p">]</span>
      <span class="p">},</span>
      <span class="s2">&quot;warningsList&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;synchList&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;archiveFile&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;resource&quot;</span><span class="p">,</span>
         <span class="s2">&quot;$&quot;</span><span class="p">:</span><span class="s2">&quot;\/home\/sg\/BackupAndRestore\/test_rest_1.zip&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;overwrite&quot;</span><span class="p">:</span><span class="n">true</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>At the end of the backup procedure you’ll be able to download the generated archive to your local file system by making an HTTP GET request to the same endpoint, using the <strong>backup ID</strong> as above and adding the <code class="docutils literal notranslate"><span class="pre">.zip</span></code> at the end</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin:geoserver&quot;</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">X</span> <span class="n">GET</span>  <span class="s2">&quot;http://mygeoserver/geoserver/rest/br/backup/1.zip&quot;</span> <span class="o">-</span><span class="n">o</span> <span class="mf">1.</span><span class="n">zip</span>
</pre></div>
</div>
</div></blockquote>
<div class="figure align-center">
<img alt="../../_images/usagerest001.png" src="../../_images/usagerest001.png" />
</div>
<p><strong>Query status of Backup executions</strong></p>
<p>Status of the operation can be queried making an HTTP GET request to the location listed in the response,</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">http://mygeoserver/geoserver/rest/br/backup/$ID.{json/xml}</span></code></p>
</div></blockquote>
<p>Replace <code class="docutils literal notranslate"><span class="pre">$ID</span></code> with the <strong>ID</strong> of the backup operation you’d like to inspect.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin:geoserver&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mygeoserver</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">br</span><span class="o">/</span><span class="n">backup</span><span class="o">/</span><span class="mf">1.</span><span class="n">json</span>
</pre></div>
</div>
</div></blockquote>
<p>or</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin:geoserver&quot;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mygeoserver</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">br</span><span class="o">/</span><span class="n">backup</span><span class="o">/</span><span class="mf">1.</span><span class="n">xml</span>
</pre></div>
</div>
</div></blockquote>
<p>GeoServer will respond with the status of the backup job corresponding to that ID</p>
<div class="figure align-center">
<img alt="../../_images/usagerest002.png" src="../../_images/usagerest002.png" />
</div>
<div class="figure align-center">
<img alt="../../_images/usagerest003.png" src="../../_images/usagerest003.png" />
</div>
<p>Here you are able to see the status of all the steps involved in the backup procedure with creation time, start time, end time, exit status etc.</p>
<p><strong>Cancel a Backup</strong></p>
<p>Cancel an in progress Backup by sending an HTTP DELETE request with the ID of the task</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -v -XDELETE -u &quot;admin:geoserver&quot; http://mygeoserver/geoserver/rest/br/backup/$ID
</pre></div>
</div>
</div></blockquote>
<p>Replace <code class="docutils literal notranslate"><span class="pre">$ID</span></code> with the <strong>ID</strong> of the backup operation you’d like to cancel.</p>
<p><strong>Initiate a Restore</strong></p>
<p>Prepare a file with a JSON object representing the Restore procedure configuration</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">restore_post.json</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;restore&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;archiveFile&quot;</span><span class="p">:</span><span class="s2">&quot;/home/sg/BackupAndRestore/test_rest_1.zip&quot;</span><span class="p">,</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>In this case we did not specify any options in the restore configuration so default values will be used.</p>
<p>Available Options are:</p>
<ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">BK_DRY_RUN</span></code>: Only test the archive do not persist the restored configuration. Default: <cite>false</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_BEST_EFFORT</span></code>: Skip any failing resources and proceed with the restore procedure. Default: <cite>false</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_PASSWORD_TOKENS</span></code>: A comma separated list of equal sign separated key/values to be replaced in data store passwords
in an incoming backup. For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>BK_PASSWORD_TOKENS=${workspace:store1.passwd.encryptedValye}=foo,${workspace:store2.passwd.encryptedValue}=bar
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_SKIP_SECURITY</span></code>: This will exclude security settings from the restore. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_SKIP_SETTINGS</span></code>: This will attempt to exclude global settings from the backup, as well as security settings. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_PURGE_RESOURCES</span></code>: If ‘false’ this parameter will avoid deleting incoming resources where possible. In particular,
existing workspaces will not be deleted during the restore. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_SKIP_GWC</span></code>: This option will avoid backup / restore the GWC catalog and folders. Default: <cite>false</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BK_CLEANUP_TEMP</span></code>: This will attempt to delete temporary folder at the end of the execution. Default: <cite>true</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exclude.file.path</span></code>: A <code class="docutils literal notranslate"><span class="pre">;</span></code> separated list of paths relative to the <code class="docutils literal notranslate"><span class="pre">GEOSERVER_DATA_DIR</span></code>
(e.g.: ‘exclude.file.path=/data/geonode;/monitoring;/geofence’). If exist, the backup / restore will skip the path listed. Default: <cite>[]</cite>.
WARNING: <code class="docutils literal notranslate"><span class="pre">security</span></code> and <code class="docutils literal notranslate"><span class="pre">workspaces</span></code> are threated differently. This option should be used only for custom external resources located under the <code class="docutils literal notranslate"><span class="pre">GEOSERVER_DATA_DIR</span></code>.</p></li>
</ol>
<p>Also an optional <code class="docutils literal notranslate"><span class="pre">Filter</span></code> can be passed to restrict the scope of the restore operation to a list of workspaces.</p>
<blockquote>
<div><p>For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;restore&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;archiveFile&quot;</span><span class="p">:</span><span class="s2">&quot;/home/sg/BackupAndRestore/test_rest_1.zip&quot;</span><span class="p">,</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;BK_DRY_RUN=true&quot;</span><span class="p">]</span>
      <span class="p">},</span>
<span class="s2">&quot;filter&quot;</span><span class="p">:</span> <span class="s2">&quot;name IN (&#39;topp&#39;,&#39;geosolutions-it&#39;)&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">archiveFile</span></code> is specified, the archive specified on that path of the remote file system will be used to initiate the restore procedure.
Otherwise you’re the archive needs to be uploaded  from your local system.</p>
<p>Then make a POST HTTP request to GeoServer’s REST interface endpoint for the restore procedure</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin:geoserver&quot;</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">--</span><span class="n">data</span> <span class="nd">@restore_post</span><span class="o">.</span><span class="n">json</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mygeoserver</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">br</span><span class="o">/</span><span class="n">restore</span><span class="o">/</span>
</pre></div>
</div>
</div></blockquote>
<p>Restore procedure will be initiated.</p>
<blockquote>
<div><p>Here is a sample response</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">201</span> <span class="n">Created</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Mon</span><span class="p">,</span> <span class="mi">01</span> <span class="n">Aug</span> <span class="mi">2016</span> <span class="mi">15</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mi">29</span> <span class="n">GMT</span>
<span class="n">Location</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mygeoserver</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">br</span><span class="o">/</span><span class="n">restore</span><span class="o">/</span><span class="mi">2</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">Noelios</span><span class="o">-</span><span class="n">Restlet</span><span class="o">-</span><span class="n">Engine</span><span class="o">/</span><span class="mf">1.0</span><span class="o">..</span><span class="mi">8</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Transfer</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="n">chunked</span>

<span class="p">{</span>
   <span class="s2">&quot;restore&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;totalNumberOfSteps&quot;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span>
      <span class="s2">&quot;execution&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
         <span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
         <span class="s2">&quot;stepExecutions&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;java.util.concurrent.CopyOnWriteArraySet&quot;</span>
         <span class="p">},</span>
         <span class="s2">&quot;status&quot;</span><span class="p">:[</span>
            <span class="s2">&quot;STARTED&quot;</span>
         <span class="p">],</span>
         <span class="s2">&quot;startTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:29.398 UTC&quot;</span><span class="p">,</span>
         <span class="s2">&quot;createTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:29.393 UTC&quot;</span><span class="p">,</span>
         <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:29.398 UTC&quot;</span><span class="p">,</span>
         <span class="s2">&quot;exitStatus&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;exitCode&quot;</span><span class="p">:</span><span class="s2">&quot;UNKNOWN&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exitDescription&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
         <span class="p">},</span>
         <span class="s2">&quot;progress&quot;</span><span class="p">:</span><span class="s2">&quot;0\/9&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;synchList&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;warningsList&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;synchList&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;archiveFile&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;resource&quot;</span><span class="p">,</span>
         <span class="s2">&quot;$&quot;</span><span class="p">:</span><span class="s2">&quot;\/home\/sg\/BackupAndRestore\/test_rest_1.zip&quot;</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="figure align-center">
<img alt="../../_images/usagerest004.png" src="../../_images/usagerest004.png" />
</div>
<p>To upload the archive from our local system instead, omit the archiveFile parameter in the JSON object and pass the <code class="docutils literal notranslate"><span class="pre">--upload-file</span></code> parameter to cURL:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">restore_post.json</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;restore&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
      <span class="p">},</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;admin:geoserver&quot;</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Content-Type: application/json&quot;</span> <span class="o">--</span><span class="n">upload</span><span class="o">-</span><span class="n">file</span> <span class="s2">&quot;archive_to_restore.zip&quot;</span> <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> <span class="o">--</span><span class="n">data</span> <span class="nd">@restore_post</span><span class="o">.</span><span class="n">json</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8081</span><span class="o">/</span><span class="n">geoserver</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">br</span><span class="o">/</span><span class="n">restore</span><span class="o">/</span>
</pre></div>
</div>
</div></blockquote>
<p>Local <code class="docutils literal notranslate"><span class="pre">archive_to_restore.zip</span></code> archive  will be uploaded and used by the restore procedure.</p>
<div class="figure align-center">
<img alt="../../_images/usagerest005.png" src="../../_images/usagerest005.png" />
</div>
<p>Query for status of Restore operations</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">http://mygeoserver/geoser/restore/$ID.{json/xml}</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;restore&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;execution&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;hash&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
         <span class="s2">&quot;key&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;long&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span>
         <span class="p">},</span>
         <span class="s2">&quot;val&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;restore&quot;</span><span class="p">,</span>
            <span class="s2">&quot;totalNumberOfSteps&quot;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span>
            <span class="s2">&quot;execution&quot;</span><span class="p">:{</span>
               <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
               <span class="s2">&quot;version&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
               <span class="s2">&quot;stepExecutions&quot;</span><span class="p">:{</span>
                  <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;java.util.concurrent.CopyOnWriteArraySet&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;step&quot;</span><span class="p">:[</span>
                     <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;restoreNamespaceInfos&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;exitStatus&quot;</span><span class="p">:{</span>
                           <span class="s2">&quot;exitCode&quot;</span><span class="p">:</span><span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;exitDescription&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;startTime&quot;</span><span class="p">:</span><span class="s2">&quot;8\/1\/16 3:07 PM&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;endTime&quot;</span><span class="p">:</span><span class="s2">&quot;8\/1\/16 3:07 PM&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span><span class="s2">&quot;8\/1\/16 3:07 PM&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;parameters&quot;</span><span class="p">:{</span>
                           <span class="s2">&quot;input.file.path&quot;</span><span class="p">:</span><span class="s2">&quot;file:\/\/\/opt\/tomcat-geoserver-2.9.x\/temp\/tmpbbe2388a-f26d-4f26-a20f-88c653d88aec&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;time&quot;</span><span class="p">:</span><span class="mi">1470064049392</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;readCount&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;writeCount&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                        <span class="s2">&quot;failureExceptions&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
                     <span class="p">},</span>
                    <span class="o">...</span>
                     <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="s2">&quot;restoreGeoServerSecurityManager&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;exitStatus&quot;</span><span class="p">:{</span>
                           <span class="s2">&quot;exitCode&quot;</span><span class="p">:</span><span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;exitDescription&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;startTime&quot;</span><span class="p">:</span><span class="s2">&quot;8\/1\/16 3:07 PM&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;endTime&quot;</span><span class="p">:</span><span class="s2">&quot;8\/1\/16 3:07 PM&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span><span class="s2">&quot;8\/1\/16 3:07 PM&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;parameters&quot;</span><span class="p">:{</span>
                           <span class="s2">&quot;input.file.path&quot;</span><span class="p">:</span><span class="s2">&quot;file:\/\/\/opt\/tomcat-geoserver-2.9.x\/temp\/tmpbbe2388a-f26d-4f26-a20f-88c653d88aec&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;time&quot;</span><span class="p">:</span><span class="mi">1470064049392</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;readCount&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;writeCount&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                        <span class="s2">&quot;failureExceptions&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
                     <span class="p">}</span>
                  <span class="p">]</span>
               <span class="p">},</span>
               <span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
               <span class="s2">&quot;startTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:29.398 UTC&quot;</span><span class="p">,</span>
               <span class="s2">&quot;createTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:29.393 UTC&quot;</span><span class="p">,</span>
               <span class="s2">&quot;endTime&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:30.356 UTC&quot;</span><span class="p">,</span>
               <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span><span class="s2">&quot;2016-08-01 15:07:30.772 UTC&quot;</span><span class="p">,</span>
               <span class="s2">&quot;exitStatus&quot;</span><span class="p">:{</span>
                  <span class="s2">&quot;exitCode&quot;</span><span class="p">:</span><span class="s2">&quot;COMPLETED&quot;</span><span class="p">,</span>
                  <span class="s2">&quot;exitDescription&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span>
               <span class="p">},</span>
               <span class="s2">&quot;progress&quot;</span><span class="p">:</span><span class="s2">&quot;9\/9&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:{</span>
               <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;synchList&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;warningsList&quot;</span><span class="p">:{</span>
               <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;synchList&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;archiveFile&quot;</span><span class="p">:{</span>
               <span class="s2">&quot;@class&quot;</span><span class="p">:</span><span class="s2">&quot;resource&quot;</span><span class="p">,</span>
               <span class="s2">&quot;$&quot;</span><span class="p">:</span><span class="s2">&quot;\/home\/sg\/BackupAndRestore\/test_rest_1.zip&quot;</span>
            <span class="p">}</span>
         <span class="p">}</span>
      <span class="p">}</span>
    <span class="o">...</span>
</pre></div>
</div>
</div></blockquote>
<p>Here you are able to see the status of all the steps involved in the restore procedure with creation time, start time, end time, exit status etc.</p>
<p><strong>Cancel a Restore</strong></p>
<p>Cancel an in progress Restore by sending an HTTP DELETE request:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>curl -v -XDELETE -u &quot;admin:geoserver&quot; http://mygeoserver/geoserver/rest/br/restore/$ID
</pre></div>
</div>
</div></blockquote>
<p>Replace <code class="docutils literal notranslate"><span class="pre">$ID</span></code> with the <strong>ID</strong> of the restore operation you’d like to cancel.</p>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="usagegui.html" title="previous chapter">Usage Via GeoServer’s User Interface</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="extensions.html" title="next chapter">Backup and Restore Extension for the management of ImageMosaic indexers</a></div>
      </div>
      </div><!-- /#content> -->
      <div id="content-right" class="content-border"></div>
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Usage Via GeoServer’s REST API</a><ul>
<li><a class="reference internal" href="#usage-example">Usage Example</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="usagegui.html" title="previous chapter">Usage Via GeoServer’s User Interface</a></li>
            <li>Next: <a href="extensions.html" title="next chapter">Backup and Restore Extension for the management of ImageMosaic indexers</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
                
        <li><a href="https://github.com/geoserver/geoserver/tree/master/doc/en/user/source/community/backuprestore/usagerest.rst">Edit</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2021, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Jul 20, 2021.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>