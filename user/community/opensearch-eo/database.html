<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>The JDBC store database structure &mdash; GeoServer 2.19.2 User Manual</title>
  <link rel="stylesheet" href="../../static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.19.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../static/jquery.js"></script>
  <script type="text/javascript" src="../../static/doctools.js"></script>
  <script type="text/javascript" src="../../static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
  <link rel="shortcut icon" href="../../static/geoserver.ico"/>
      <link rel="search" title="Search" href="../../search.html" />
      <link rel="top" title="GeoServer 2.19.2 User Manual" href="../../index.html" />
      <link rel="up" title="OpenSearch for EO" href="index.html" />
      <link rel="next" title="Automation with the administration REST API" href="automation.html" />
      <link rel="prev" title="Configuring the OpenSearch module" href="configuration.html" />
</head>
<body class="community/opensearch-eo/database">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.19.2 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/about">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/download">Download</a></li>
        <!--<li><a href="../../index.html">Documentation</a></li>-->
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content-left" class="content-border"></div>
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.19.2 User Manual</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Community modules</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">OpenSearch for EO</a> &raquo;</li>
  <li>The JDBC store database structure</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../../py-modindex.html" title="Python Module Index"
       accesskey="">modules</a></li>
  <li>
    <a href="automation.html" title="Automation with the administration REST API"
       accesskey="N">next</a>|</li>
  <li>
    <a href="configuration.html" title="Configuring the OpenSearch module"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="the-jdbc-store-database-structure">
<span id="opensearch-database"></span><h1>The JDBC store database structure<a class="headerlink" href="#the-jdbc-store-database-structure" title="Permalink to this headline">¶</a></h1>
<p>The JDBC store uses a conventional relational structure, depicted in the following picture:</p>
<div class="figure align-default">
<img alt="../../_images/dbschema.png" src="../../_images/dbschema.png" />
</div>
<p>So a <code class="docutils literal notranslate"><span class="pre">collection</span></code> has its own primary search attributes, as well as:</p>
<ul class="simple">
<li><p>A ISO metadata document as large associated text</p></li>
<li><p>Zero or more OGC links pointing to where the collection is published</p></li>
<li><p>Layer publishing information (for auto-generation of mosaic, layer and eventual coverage view in case the actual data resides locally)</p></li>
<li><p>One or more products</p></li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">product</span></code> in turn is associated to:</p>
<ul class="simple">
<li><p>A O&amp;M metadata document as large associated text</p></li>
<li><p>A thumbnail image, in PNG or JPEG format</p></li>
<li><p>Zero or more OGC links pointing to where the product is published</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">granule</span></code> table is designed to contain per product file information in case there
is a desire to publish the actual data from the same local GeoServer (but in general, OGC services
might be missing or provided by a separate server).</p>
<div class="section" id="collections">
<h2>Collections<a class="headerlink" href="#collections" title="Permalink to this headline">¶</a></h2>
<p>The collection table currently looks as follows (check the SQL file in the installation instructions for
a more up to date version of it):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">create</span> <span class="k">table</span> <span class="n">collection</span> <span class="p">(</span>
  <span class="ss">&quot;id&quot;</span> <span class="nb">serial</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="ss">&quot;name&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;primary&quot;</span> <span class="nb">boolean</span><span class="p">,</span>
  <span class="ss">&quot;htmlDescription&quot;</span> <span class="nb">text</span><span class="p">,</span>
  <span class="ss">&quot;footprint&quot;</span> <span class="n">geography</span><span class="p">(</span><span class="n">Polygon</span><span class="p">,</span> <span class="mi">4326</span><span class="p">),</span>
  <span class="ss">&quot;timeStart&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;timeEnd&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;productCqlFilter&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;masked&quot;</span> <span class="nb">boolean</span><span class="p">,</span>
  <span class="ss">&quot;eoIdentifier&quot;</span> <span class="nb">varchar</span> <span class="k">unique</span><span class="p">,</span>
  <span class="ss">&quot;eoProductType&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoPlatform&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoPlatformSerialIdentifier&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoInstrument&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoSensorType&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;eoSensorType&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;OPTICAL&#39;</span><span class="p">,</span> <span class="s1">&#39;RADAR&#39;</span><span class="p">,</span> <span class="s1">&#39;ALTIMETRIC&#39;</span><span class="p">,</span> <span class="s1">&#39;ATMOSPHERIC&#39;</span><span class="p">,</span> <span class="s1">&#39;LIMB&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;eoCompositeType&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoProcessingLevel&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoOrbitType&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoSpectralRange&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoWavelength&quot;</span> <span class="nb">int</span><span class="p">,</span>
  <span class="ss">&quot;eoSecurityConstraints&quot;</span> <span class="nb">boolean</span><span class="p">,</span>
  <span class="ss">&quot;eoDissemination&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoAcquisitionStation&quot;</span> <span class="nb">varchar</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Most of the attributes should be rather self-explanatory to those familiar with OGC Earth Observation terminology.
Each attribute prefixed by “eo” is exposed as a search attribute in OpenSearch, the structure can be modified
by adding extra attributes and they will show up and made searchable.</p>
<p>Specific attributes notes:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">primary</span></code> collection is normally linked to a particular satellite/sensor and contains its own products.
Setting “primary” to false makes the collection “virtual” and the <code class="docutils literal notranslate"><span class="pre">productCQLFilter</span></code> field should be filled with
a CQL filter that will collect all the products in the collection (warning, virtual collections are largerly
untested at the moment)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">footprint</span></code> field is used for spatial searches, while <code class="docutils literal notranslate"><span class="pre">timeStart</span></code> and <code class="docutils literal notranslate"><span class="pre">timeEnd</span></code> are used for
temporal ones</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">htmlDescription</span></code> drives the generation of the visible part of the Atom OpenSearch response, see the
dedicated section later to learn more about filling it</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">collection_metadata</span></code> table contains the ISO metadata for the given collection.
The OpenSearch module has no understanding of its contents, it will simply return it as is, allowing for
extra flexibility but also moving the responsibility for correctness checks completely to the author.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">collection_ogclink</span></code> table contains the OGC links towards the services providing visualization and
download access to the collection contents. See the “OGC links” section to gather more information about it.</p>
</div>
<div class="section" id="products">
<h2>Products<a class="headerlink" href="#products" title="Permalink to this headline">¶</a></h2>
<p>The product table currently looks as follows (check the SQL file in the installation instructions for
a more up to date version of it):</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- the products and attributes describing them</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">product</span> <span class="p">(</span>
  <span class="ss">&quot;id&quot;</span> <span class="nb">serial</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="ss">&quot;htmlDescription&quot;</span> <span class="nb">text</span><span class="p">,</span>
  <span class="ss">&quot;footprint&quot;</span> <span class="n">geography</span><span class="p">(</span><span class="n">Polygon</span><span class="p">,</span> <span class="mi">4326</span><span class="p">),</span>
  <span class="ss">&quot;timeStart&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;timeEnd&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;originalPackageLocation&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;originalPackageType&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;thumbnailURL&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;quicklookURL&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;crs&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoIdentifier&quot;</span> <span class="nb">varchar</span> <span class="k">unique</span><span class="p">,</span>
  <span class="ss">&quot;eoParentIdentifier&quot;</span> <span class="nb">varchar</span> <span class="k">references</span> <span class="n">collection</span><span class="p">(</span><span class="ss">&quot;eoIdentifier&quot;</span><span class="p">)</span> <span class="k">on</span> <span class="k">delete</span> <span class="k">cascade</span><span class="p">,</span>
  <span class="ss">&quot;eoProductionStatus&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoAcquisitionType&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;eoAcquisitionType&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;NOMINAL&#39;</span><span class="p">,</span> <span class="s1">&#39;CALIBRATION&#39;</span><span class="p">,</span> <span class="s1">&#39;OTHER&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;eoOrbitNumber&quot;</span> <span class="nb">int</span><span class="p">,</span>
  <span class="ss">&quot;eoOrbitDirection&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;eoOrbitDirection&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;ASCENDING&#39;</span><span class="p">,</span> <span class="s1">&#39;DESCENDING&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;eoTrack&quot;</span> <span class="nb">int</span><span class="p">,</span>
  <span class="ss">&quot;eoFrame&quot;</span> <span class="nb">int</span><span class="p">,</span>
  <span class="ss">&quot;eoSwathIdentifier&quot;</span> <span class="nb">text</span><span class="p">,</span>
  <span class="ss">&quot;optCloudCover&quot;</span> <span class="nb">int</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;optCloudCover&quot;</span> <span class="k">between</span> <span class="mi">0</span> <span class="k">and</span> <span class="mi">100</span><span class="p">),</span>
  <span class="ss">&quot;optSnowCover&quot;</span> <span class="nb">int</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;optSnowCover&quot;</span> <span class="k">between</span> <span class="mi">0</span> <span class="k">and</span> <span class="mi">100</span><span class="p">),</span>
  <span class="ss">&quot;eoProductQualityStatus&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;eoProductQualityStatus&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;NOMINAL&#39;</span><span class="p">,</span> <span class="s1">&#39;DEGRADED&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;eoProductQualityDegradationStatus&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoProcessorName&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoProcessingCenter&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoCreationDate&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;eoModificationDate&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;eoProcessingDate&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;eoSensorMode&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoArchivingCenter&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoProcessingMode&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoAvailabilityTime&quot;</span> <span class="k">timestamp</span><span class="p">,</span>
  <span class="ss">&quot;eoAcquisitionStation&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoAcquisitionSubtype&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;eoStartTimeFromAscendingNode&quot;</span> <span class="nb">int</span><span class="p">,</span>
  <span class="ss">&quot;eoCompletionTimeFromAscendingNode&quot;</span> <span class="nb">int</span><span class="p">,</span>
  <span class="ss">&quot;eoIlluminationAzimuthAngle&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;eoIlluminationZenithAngle&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;eoIlluminationElevationAngle&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;sarPolarisationMode&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;sarPolarisationMode&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;sarPolarisationChannels&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;sarPolarisationChannels&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="s1">&#39;vertical&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;sarAntennaLookDirection&quot;</span> <span class="nb">varchar</span> <span class="k">check</span> <span class="p">(</span><span class="ss">&quot;sarAntennaLookDirection&quot;</span> <span class="k">in</span> <span class="p">(</span><span class="s1">&#39;LEFT&#39;</span><span class="p">,</span> <span class="s1">&#39;RIGHT&#39;</span><span class="p">)),</span>
  <span class="ss">&quot;sarMinimumIncidenceAngle&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;sarMaximumIncidenceAngle&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;sarDopplerFrequency&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;sarIncidenceAngleVariation&quot;</span> <span class="nb">float</span><span class="p">,</span>
  <span class="ss">&quot;eoResolution&quot;</span> <span class="nb">float</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Notes on the attributes:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">footprint</span></code> field is used for spatial searches, while <code class="docutils literal notranslate"><span class="pre">timeStart</span></code> and <code class="docutils literal notranslate"><span class="pre">timeEnd</span></code> are used for
temporal ones</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">htmlDescription</span></code> drives the generation of the visible part of the Atom OpenSearch response, see the
dedicated section later to learn more about filling it</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">crs</span></code> attribute is optional and is used only for automatic layer publishing for collections having
heterogeneous CRS products. It must contain a “EPSG:XYWZ” expression (but the product footprint still
need to be expressed in WGS84, east/north oriented).</p></li>
<li><p>The EO search attributes need to be filled according to the nature of the product, <code class="docutils literal notranslate"><span class="pre">eo</span></code> prefixes generic
EOP attributes, <code class="docutils literal notranslate"><span class="pre">opt</span></code> optical ones, <code class="docutils literal notranslate"><span class="pre">sar</span></code> radar ones, <code class="docutils literal notranslate"><span class="pre">atm</span></code> altimetric, <code class="docutils literal notranslate"><span class="pre">lmb</span></code> limbic, <code class="docutils literal notranslate"><span class="pre">ssp</span></code>
Synthesis and Systematic Product. New attributes can be added based on the above prefixes (at the time
of writing only optical and sar attributes have been tested)</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">product_metadata</span></code> table contains the O&amp;M metadata for the given product.
The OpenSearch module has no understanding of its contents, it will simply return it as is, allowing for
extra flexibility but also moving the responsibility for correctness checks completely to the author.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">product_thumb</span></code> table contains the product thumbnail, in PNG or JPEG format, for display
in the OpenSearch Atom output.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">product_ogclink</span></code> table contains the OGC links towards the services providing visualization and
download access to the collection contents. See the “OGC links” section to gather more information about it.</p>
</div>
<div class="section" id="the-htmldescription-field">
<h2>The <code class="docutils literal notranslate"><span class="pre">htmlDescription</span></code> field<a class="headerlink" href="#the-htmldescription-field" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">htmlDescription</span></code> is used to fill the user visible part of a OpenSearch ATOM response.
The contents are completely freeform, but some variable can be put in the HTML that GeoServer will replace:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">${QUICKLOOK_URL}</span></code> points to the product quicklook (at the time of writing, same as the thumbnail)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${THUMB_URL}</span></code> points to the product thumbnail</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${ATOM_URL}</span></code> points to the specific Atom record at hand (either the collection or product one)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${OM_METADATA_URL}</span></code> points to the product O&amp;M metadata</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">${ISO_METADATA_LINK}</span></code> points to the ISO metadata link</p></li>
</ul>
</div>
<div class="section" id="ogc-links">
<h2>OGC links<a class="headerlink" href="#ogc-links" title="Permalink to this headline">¶</a></h2>
<p>The OpenSearch module implements “OGC cross linking” by adding pointers to OGC services
for to collection/product visualization and download.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- links for collections</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">collection_ogclink</span> <span class="p">(</span>
  <span class="ss">&quot;lid&quot;</span> <span class="nb">serial</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="ss">&quot;collection_id&quot;</span> <span class="nb">int</span> <span class="k">references</span> <span class="n">collection</span><span class="p">(</span><span class="ss">&quot;id&quot;</span><span class="p">)</span> <span class="k">on</span> <span class="k">delete</span> <span class="k">cascade</span><span class="p">,</span>
  <span class="ss">&quot;offering&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;method&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;code&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;type&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;href&quot;</span> <span class="nb">varchar</span>
<span class="p">);</span>

<span class="c1">-- links for products</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">product_ogclink</span> <span class="p">(</span>
  <span class="ss">&quot;lid&quot;</span> <span class="nb">serial</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="ss">&quot;product_id&quot;</span> <span class="nb">int</span> <span class="k">references</span> <span class="n">product</span><span class="p">(</span><span class="ss">&quot;id&quot;</span><span class="p">)</span> <span class="k">on</span> <span class="k">delete</span> <span class="k">cascade</span><span class="p">,</span>
  <span class="ss">&quot;offering&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;method&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;code&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;type&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;href&quot;</span> <span class="nb">varchar</span>
<span class="p">);</span>
</pre></div>
</div>
<p>This is done by adding a set of <code class="docutils literal notranslate"><span class="pre">owc:offering</span></code> elements in the Atom response, mapping directly
from the table contents:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;owc:offering</span> <span class="na">code=</span><span class="s">&quot;http://www.opengis.net/spec/owc/1.0/req/atom/wcs&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;owc:operation</span> <span class="na">method=</span><span class="s">&quot;GET&quot;</span> <span class="na">code=</span><span class="s">&quot;GetCapabilities&quot;</span> <span class="na">href=</span><span class="s">&quot;http://localhost/sentinel2/sentinel2-TCI/ows?service=WCS&amp;amp;version=2.0.1&amp;amp;request=GetCapabilities&quot;</span> <span class="na">type=</span><span class="s">&quot;application/xml&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/owc:offering&gt;</span>
<span class="nt">&lt;owc:offering</span> <span class="na">code=</span><span class="s">&quot;http://www.opengis.net/spec/owc/1.0/req/atom/wmts&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;owc:operation</span> <span class="na">method=</span><span class="s">&quot;GET&quot;</span> <span class="na">code=</span><span class="s">&quot;GetCapabilities&quot;</span> <span class="na">href=</span><span class="s">&quot;http://localhost/sentinel2/sentinel2-TCI/gwc/service/wmts?REQUEST=GetCapabilities&quot;</span> <span class="na">type=</span><span class="s">&quot;application/xml&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/owc:offering&gt;</span>
<span class="nt">&lt;owc:offering</span> <span class="na">code=</span><span class="s">&quot;http://www.opengis.net/spec/owc/1.0/req/atom/wms&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;owc:operation</span> <span class="na">method=</span><span class="s">&quot;GET&quot;</span> <span class="na">code=</span><span class="s">&quot;GetCapabilities&quot;</span> <span class="na">href=</span><span class="s">&quot;http://localhost/sentinel2/sentinel2-TCI/ows?service=wms&amp;amp;version=1.3.0&amp;amp;request=GetCapabilities&quot;</span> <span class="na">type=</span><span class="s">&quot;application/xml&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;owc:operation</span> <span class="na">method=</span><span class="s">&quot;GET&quot;</span> <span class="na">code=</span><span class="s">&quot;GetMap&quot;</span> <span class="na">href=</span><span class="s">&quot;http://localhost/sentinel2/sentinel2:sentinel2-TCI/wms?SERVICE=WMS&amp;amp;VERSION=1.1.1&amp;amp;REQUEST=GetMap&amp;amp;FORMAT=image%2Fjpeg&amp;amp;STYLES&amp;amp;LAYERS=sentinel2%3Asentinel2-TCI&amp;amp;SRS=EPSG%3A4326&amp;amp;WIDTH=800&amp;amp;HEIGHT=600&amp;amp;BBOX=-180%2C-90%2C180%2C90&quot;</span> <span class="na">type=</span><span class="s">&quot;image/jpeg&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/owc:offering&gt;</span>
</pre></div>
</div>
<p>The contents of the tables need to be filled with the sane named elements of a OWC offering,
the <code class="docutils literal notranslate"><span class="pre">href</span></code> one can contain a <code class="docutils literal notranslate"><span class="pre">${BASE_URL}</span></code> variable that GeoServer will replace with its
own base URL.</p>
</div>
<div class="section" id="the-granule-table">
<h2>The granule table<a class="headerlink" href="#the-granule-table" title="Permalink to this headline">¶</a></h2>
<p>The granule table can be filled with information about the actual raster files making up
a certain product in order to publish the collection as a GeoServer image mosaic:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- the granules table (might be abstract, and we can use partitioning)</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">granule</span> <span class="p">(</span>
  <span class="ss">&quot;gid&quot;</span> <span class="nb">serial</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
  <span class="ss">&quot;product_id&quot;</span> <span class="nb">int</span> <span class="k">not</span> <span class="k">null</span> <span class="k">references</span> <span class="n">product</span><span class="p">(</span><span class="ss">&quot;id&quot;</span><span class="p">)</span> <span class="k">on</span> <span class="k">delete</span> <span class="k">cascade</span><span class="p">,</span>
  <span class="ss">&quot;band&quot;</span> <span class="nb">varchar</span><span class="p">,</span>
  <span class="ss">&quot;location&quot;</span> <span class="nb">varchar</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
  <span class="ss">&quot;the_geom&quot;</span> <span class="n">geometry</span><span class="p">(</span><span class="n">Polygon</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span>
<span class="p">);</span>
</pre></div>
</div>
<p>The granules associated to a product can have different topologies:</p>
<ul class="simple">
<li><p>A single raster file containing all the information about the product</p></li>
<li><p>Multiple raster files splitting the products spatially in regular tiles</p></li>
<li><p>Multiple raster files splitting the product wavelenght wise</p></li>
<li><p>A mix of the two above</p></li>
</ul>
<p>Notes about the columns:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">band</span></code> column need to be filled only for products split in several files by bands, at the time of
writing it needs to be a progressive integer starting from 1 (the module will hopefully allow more meaningful band names in the future)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">location</span></code> is the absolute path of the file</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">the_geom</span></code> field is a polygon in WGS84, regardless of what the actual footprint of the file is. The polygon must represent the rectangular extend of the raster file,
not its valid area (masking is to be treated separately, either with sidecar mask files or with NODATA pixels)</p></li>
</ul>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="configuration.html" title="previous chapter">Configuring the OpenSearch module</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="automation.html" title="next chapter">Automation with the administration REST API</a></div>
      </div>
      </div><!-- /#content> -->
      <div id="content-right" class="content-border"></div>
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">The JDBC store database structure</a><ul>
<li><a class="reference internal" href="#collections">Collections</a></li>
<li><a class="reference internal" href="#products">Products</a></li>
<li><a class="reference internal" href="#the-htmldescription-field">The <code class="docutils literal notranslate"><span class="pre">htmlDescription</span></code> field</a></li>
<li><a class="reference internal" href="#ogc-links">OGC links</a></li>
<li><a class="reference internal" href="#the-granule-table">The granule table</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="configuration.html" title="previous chapter">Configuring the OpenSearch module</a></li>
            <li>Next: <a href="automation.html" title="next chapter">Automation with the administration REST API</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
                
        <li><a href="https://github.com/geoserver/geoserver/tree/master/doc/en/user/source/community/opensearch-eo/database.rst">Edit</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2021, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Jul 20, 2021.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>