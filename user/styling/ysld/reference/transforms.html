<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Transforms &mdash; GeoServer 2.19.2 User Manual</title>
  <link rel="stylesheet" href="../../../static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../../static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../../static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../../static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.19.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../../static/jquery.js"></script>
  <script type="text/javascript" src="../../../static/doctools.js"></script>
  <script type="text/javascript" src="../../../static/searchtools.js"></script>
  <script type="text/javascript" src="../../../searchindex.js"></script>
  <link rel="shortcut icon" href="../../../static/geoserver.ico"/>
      <link rel="search" title="Search" href="../../../search.html" />
      <link rel="top" title="GeoServer 2.19.2 User Manual" href="../../../index.html" />
      <link rel="up" title="YSLD reference" href="index.html" />
      <link rel="next" title="YSLD Cookbook" href="../cookbook/index.html" />
      <link rel="prev" title="Variables" href="variables.html" />
</head>
<body class="styling/ysld/reference/transforms">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../../index.html">GeoServer 2.19.2 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/about">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/download">Download</a></li>
        <!--<li><a href="../../../index.html">Documentation</a></li>-->
      </ul>
        <form id="quick-search" action="../../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../../static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content-left" class="content-border"></div>
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../../index.html">GeoServer 2.19.2 User Manual</a> &raquo;</li>
  <li><a href="../../index.html" accesskey="U">Styling</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">YSLD Styling</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">YSLD reference</a> &raquo;</li>
  <li>Transforms</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../../../py-modindex.html" title="Python Module Index"
       accesskey="">modules</a></li>
  <li>
    <a href="../cookbook/index.html" title="YSLD Cookbook"
       accesskey="N">next</a>|</li>
  <li>
    <a href="variables.html" title="Variables"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="transforms">
<span id="ysld-reference-transforms"></span><h1>Transforms<a class="headerlink" href="#transforms" title="Permalink to this headline">¶</a></h1>
<p>YSLD allows for the use of rendering transformations. Rendering transformations are processes on the server that are executed inside the rendering pipeline, to allow for dynamic data transformations. In GeoServer, rendering transformations are typically exposed as WPS processes.</p>
<p>For example, one could create a style that applies to a point layer, and applies a Heatmap process as a rendering transformation, making the output a (raster) heatmap.</p>
<p>Because rendering transformations can change the geometry type, it is important to make sure that the <a class="reference internal" href="symbolizers/index.html#ysld-reference-symbolizers"><span class="std std-ref">symbolizer</span></a> used matches the <em>output</em> of the rendering transformation, not the input. In the above heatmap example, the appropriate symbolizer would be a raster symbolizer, as the output of a heatmap is a raster.</p>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>The full syntax for using a rendering transformation is:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">feature-styles</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">transform</span><span class="p p-Indicator">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;text&gt;</span>
    <span class="nt">params</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;options&gt;</span>
<span class=" -Error">  </span><span class="nt">rules</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<p>where:</p>
<table class="colwidths-given non-responsive docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 10%" />
<col style="width: 50%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head stub"><p>Property</p></th>
<th class="head"><p>Required?</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></th>
<td><p>Yes</p></td>
<td><p>Full name of the rendering transform including any prefixes (such as <code class="docutils literal notranslate"><span class="pre">vec:Heatmap</span></code>)</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">params</span></code></p></th>
<td><p>Yes</p></td>
<td><p>All input parameters for the rendering transformation. Content will vary greatly based on the amount and type of parameters needed.</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
<p>The values in the <code class="docutils literal notranslate"><span class="pre">params</span></code> options typically include values, strings, or attributes. However, it can be useful with a transformation to include environment parameters that concern the position and size of the map when it is rendered. For example, the following are common reserved environment parameters:</p>
<table class="colwidths-given non-responsive docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head stub"><p>Environment parameter</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">env('wms_bbox')</span></code></p></th>
<td><p>The bounding box of the request</p></td>
</tr>
<tr class="row-odd"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">env('wms_width')</span></code></p></th>
<td><p>The width of the request</p></td>
</tr>
<tr class="row-even"><th class="stub"><p><code class="docutils literal notranslate"><span class="pre">env('wms_height')</span></code></p></th>
<td><p>The height of the request</p></td>
</tr>
</tbody>
</table>
<p>With this in mind, the following <code class="docutils literal notranslate"><span class="pre">params</span></code> are assumed unless otherwise specified:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">params</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
  <span class="l l-Scalar l-Scalar-Plain">outputBBOX</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">${env(&#39;wms_bbox&#39;)}</span>
  <span class="nt">outputWidth</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${env(&#39;wms_width&#39;)}</span>
  <span class="nt">outputHeight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${env(&#39;wms_height&#39;)}</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that the transform happens <em>outside</em> of the <a class="reference internal" href="rules.html#ysld-reference-rules"><span class="std std-ref">rules</span></a> and <a class="reference internal" href="symbolizers/index.html#ysld-reference-symbolizers"><span class="std std-ref">symbolizers</span></a>, but inside the <a class="reference internal" href="featurestyles.html#ysld-reference-featurestyles"><span class="std std-ref">feature styles</span></a>.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="heatmap">
<h3>Heatmap<a class="headerlink" href="#heatmap" title="Permalink to this headline">¶</a></h3>
<p>The following uses the <code class="docutils literal notranslate"><span class="pre">vec:Heatmap</span></code> process to convert a point layer to a heatmap raster:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Heatmap</span>
<span class="nt">feature-styles</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">transform</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vec:Heatmap</span>
    <span class="nt">params</span><span class="p">:</span>
      <span class="nt">weightAttr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pop2000</span>
      <span class="nt">radiusPixels</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
      <span class="nt">pixelsPerCell</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
  <span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">symbolizers</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">raster</span><span class="p">:</span>
        <span class="nt">opacity</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.6</span>
        <span class="nt">color-map</span><span class="p">:</span>
          <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ramp</span>
          <span class="nt">entries</span><span class="p">:</span>
          <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;#FFFFFF&#39;</span><span class="p p-Indicator">,</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="nv">0.0</span><span class="p p-Indicator">,</span><span class="nv">nodata</span><span class="p p-Indicator">]</span>
          <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;#4444FF&#39;</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">0.1</span><span class="p p-Indicator">,</span><span class="nv">nodata</span><span class="p p-Indicator">]</span>
          <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;#FF0000&#39;</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">0.5</span><span class="p p-Indicator">,</span><span class="nv">values</span><span class="p p-Indicator">]</span>
          <span class="p p-Indicator">-</span> <span class="p p-Indicator">[</span><span class="s">&#39;#FFFF00&#39;</span><span class="p p-Indicator">,</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">1.0</span><span class="p p-Indicator">,</span><span class="nv">values</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
<div class="section" id="point-stacker">
<h3>Point Stacker<a class="headerlink" href="#point-stacker" title="Permalink to this headline">¶</a></h3>
<p>The point stacker transform can be used to combine points that are close together. This transform acts on a point geometry layer, and combines any points that are within a single cell as specified by the <code class="docutils literal notranslate"><span class="pre">cellSize</span></code> parameter. The resulting geometry has attributes <code class="docutils literal notranslate"><span class="pre">geom</span></code> (the geometry), <code class="docutils literal notranslate"><span class="pre">count</span></code> (the number of features represented by this point) and <code class="docutils literal notranslate"><span class="pre">countUnique</span></code> (the number of unique features represented by this point). These attributes can be used to size and label the points based on how many points are combined together:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">title</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">pointstacker</span>
<span class="nt">feature-styles</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">transform</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">vec:PointStacker</span>
    <span class="nt">params</span><span class="p">:</span>
    <span class="nt">cellSize</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
  <span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">symbolizers</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">point</span><span class="p">:</span>
        <span class="nt">size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${8*sqrt(count)}</span>
        <span class="nt">symbols</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">mark</span><span class="p">:</span>
            <span class="nt">shape</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">circle</span>
            <span class="nt">fill-color</span><span class="p">:</span> <span class="s">&#39;#EE0000&#39;</span>
  <span class="p p-Indicator">-</span> <span class="nt">filter</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">count &gt; 1</span>
    <span class="nt">symbolizers</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">text</span><span class="p">:</span>
          <span class="nt">fill-color</span><span class="p">:</span> <span class="s">&#39;#FFFFFF&#39;</span>
          <span class="nt">font-family</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Arial</span>
          <span class="nt">font-size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">10</span>
          <span class="nt">font-weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">bold</span>
          <span class="nt">label</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${count}</span>
          <span class="nt">placement</span><span class="p">:</span>
              <span class="nt">anchor</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="nv">0.5</span><span class="p p-Indicator">,</span><span class="nv">0.75</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<div class="figure align-default" id="id1">
<img alt="../../../_images/transforms_pointstacker.png" src="../../../_images/transforms_pointstacker.png" />
<p class="caption"><span class="caption-text">Point stacker</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="variables.html" title="previous chapter">Variables</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../cookbook/index.html" title="next chapter">YSLD Cookbook</a></div>
      </div>
      </div><!-- /#content> -->
      <div id="content-right" class="content-border"></div>
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Transforms</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#heatmap">Heatmap</a></li>
<li><a class="reference internal" href="#point-stacker">Point Stacker</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="variables.html" title="previous chapter">Variables</a></li>
            <li>Next: <a href="../cookbook/index.html" title="next chapter">YSLD Cookbook</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
                
        <li><a href="https://github.com/geoserver/geoserver/tree/master/doc/en/user/source/styling/ysld/reference/transforms.rst">Edit</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2021, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Jul 20, 2021.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>