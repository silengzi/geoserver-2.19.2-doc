<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>GetLegendGraphic &mdash; GeoServer 2.19.2 User Manual</title>
  <link rel="stylesheet" href="../../../static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../../static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../../static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../../static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.19.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../../static/jquery.js"></script>
  <script type="text/javascript" src="../../../static/doctools.js"></script>
  <script type="text/javascript" src="../../../static/searchtools.js"></script>
  <script type="text/javascript" src="../../../searchindex.js"></script>
  <link rel="shortcut icon" href="../../../static/geoserver.ico"/>
      <link rel="search" title="Search" href="../../../search.html" />
      <link rel="top" title="GeoServer 2.19.2 User Manual" href="../../../index.html" />
      <link rel="up" title="Web Map Service (WMS)" href="../index.html" />
      <link rel="next" title="WMS Decorations" href="../decoration.html" />
      <link rel="prev" title="Global variables affecting WMS" href="../global.html" />
</head>
<body class="services/wms/get_legend_graphic/index">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../../index.html">GeoServer 2.19.2 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/about">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/download">Download</a></li>
        <!--<li><a href="../../../index.html">Documentation</a></li>-->
      </ul>
        <form id="quick-search" action="../../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../../static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content-left" class="content-border"></div>
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../../index.html">GeoServer 2.19.2 User Manual</a> &raquo;</li>
  <li><a href="../../index.html" accesskey="U">Services</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Web Map Service (WMS)</a> &raquo;</li>
  <li>GetLegendGraphic</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../../../py-modindex.html" title="Python Module Index"
       accesskey="">modules</a></li>
  <li>
    <a href="../decoration.html" title="WMS Decorations"
       accesskey="N">next</a>|</li>
  <li>
    <a href="../global.html" title="Global variables affecting WMS"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="getlegendgraphic">
<span id="get-legend-graphic"></span><h1>GetLegendGraphic<a class="headerlink" href="#getlegendgraphic" title="Permalink to this headline">¶</a></h1>
<p>This chapter describes whether to use the GetLegendGraphics request. The SLD Specifications 1.0.0 gives a good description about GetLegendGraphic requests:</p>
<p><cite>The GetLegendGraphic operation itself is optional for an SLD-enabled WMS. It provides a general mechanism for acquiring legend symbols, beyond the LegendURL reference of WMS Capabilities. Servers supporting the GetLegendGraphic call might code LegendURL references as GetLegendGraphic for interface consistency. Vendor-specific parameters may be added to GetLegendGraphic requests and all of the usual OGC-interface options and rules apply. No XML-POST method for GetLegendGraphic is presently defined</cite>.</p>
<p>Here is an example invocation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=20&amp;HEIGHT=20&amp;LAYER=topp:states
</pre></div>
</div>
<p>which would produce four 20x20 icons that graphically represent the rules of the default style of the topp:states layer.</p>
<div class="figure align-center" id="id1">
<img alt="../../../images/samplelegend.png" src="../../../images/samplelegend.png" />
<p class="caption"><span class="caption-text"><em>Sample legend</em></span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>The following table lists the whole set of GetLegendGraphic parameters that can be used.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 5%" />
<col style="width: 80%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Parameter</strong></p></td>
<td><p><strong>Required</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p><em>REQUEST</em></p></td>
<td><p>Required</p></td>
<td><p>Value must be “GetLegendGraphic”.</p></td>
</tr>
<tr class="row-odd"><td><p><em>LAYER</em></p></td>
<td><p>Required</p></td>
<td><p>Layer for which to produce legend graphic.</p></td>
</tr>
<tr class="row-even"><td><p><em>STYLE</em></p></td>
<td><p>Optional</p></td>
<td><p>Style of layer for which to produce legend graphic. If not present, the default style is selected. The style may be any valid style available for a layer, including non-SLD internally-defined styles.</p></td>
</tr>
<tr class="row-odd"><td><p><em>FEATURETYPE</em></p></td>
<td><p>Optional</p></td>
<td><p>Feature type for which to produce the legend graphic. This is not needed if the layer has only a single feature type.</p></td>
</tr>
<tr class="row-even"><td><p><em>RULE</em></p></td>
<td><p>Optional</p></td>
<td><p>Rule of style to produce legend graphic for, if applicable. In the case that a style has multiple rules but no specific rule is selected, then the map server is obligated to produce a graphic that is representative of all of the rules of the style.</p></td>
</tr>
<tr class="row-odd"><td><p><em>SCALE</em></p></td>
<td><p>Optional</p></td>
<td><p>In the case that a RULE is not specified for a style, this parameter may assist the server in selecting a more appropriate representative graphic by eliminating internal rules that are out-of-scope. This value is a standardized scale denominator, defined in Section 10.2. Specifying the scale will also make the symbolizers using Unit Of Measure resize according to the specified scale.</p></td>
</tr>
<tr class="row-even"><td><p><em>SLD</em></p></td>
<td><p>Optional</p></td>
<td><p>This parameter specifies a reference to an external SLD document. It works in the same way as the SLD= parameter of the WMS GetMap operation.</p></td>
</tr>
<tr class="row-odd"><td><p><em>SLD_BODY</em></p></td>
<td><p>Optional</p></td>
<td><p>This parameter allows an SLD document to be included directly in an HTTP-GET request. It works in the same way as the SLD_BODY= parameter of the WMS GetMap operation.</p></td>
</tr>
<tr class="row-even"><td><p><em>FORMAT</em></p></td>
<td><p>Required</p></td>
<td><p>This gives the MIME type of the file format in which to return the legend graphic. Allowed values are the same as for the FORMAT= parameter of the WMS GetMap request.</p></td>
</tr>
<tr class="row-odd"><td><p><em>WIDTH</em></p></td>
<td><p>Optional</p></td>
<td><p>This gives a hint for the width of the returned graphic in pixels. Vector-graphics can use this value as a hint for the level of detail to include.</p></td>
</tr>
<tr class="row-even"><td><p><em>HEIGHT</em></p></td>
<td><p>Optional</p></td>
<td><p>This gives a hint for the height of the returned graphic in pixels.</p></td>
</tr>
<tr class="row-odd"><td><p><em>EXCEPTIONS</em></p></td>
<td><p>Optional</p></td>
<td><p>This gives the MIME type of the format in which to return exceptions. Allowed values are the same as for the EXCEPTIONS= parameter of the WMS GetMap request.</p></td>
</tr>
<tr class="row-even"><td><p><em>LANGUAGE</em></p></td>
<td><p>Optional</p></td>
<td><p>Allows setting labels language for style titles and rules titles; needs a correctly localized SLD to work properly; if labels are not available in the requested language, the default text will be used; look at <a class="reference internal" href="../../../styling/sld/language.html#sld-language"><span class="std std-ref">i18N in SLD</span></a> for further details.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="controlling-legend-appearance-with-legend-options">
<span id="get-legend-graphic-options"></span><h2>Controlling legend appearance with LEGEND_OPTIONS<a class="headerlink" href="#controlling-legend-appearance-with-legend-options" title="Permalink to this headline">¶</a></h2>
<p>GeoServer allows finer control over the legend appearance via the vendor parameter <code class="docutils literal notranslate"><span class="pre">LEGEND_OPTIONS</span></code>.
The general format of <code class="docutils literal notranslate"><span class="pre">LEGEND_OPTIONS</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">FORMAT_OPTIONS</span></code>, that is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...&amp;</span><span class="n">LEGEND_OPTIONS</span><span class="o">=</span><span class="n">key1</span><span class="p">:</span><span class="n">v1</span><span class="p">;</span><span class="n">key2</span><span class="p">:</span><span class="n">v2</span><span class="p">;</span><span class="o">...</span><span class="p">;</span><span class="n">keyn</span><span class="p">:</span><span class="n">vn</span>
</pre></div>
</div>
<p>Here is a description of the various parameters that can be used in <code class="docutils literal notranslate"><span class="pre">LEGEND_OPTIONS</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>fontName (string)</strong> the name of the font to be used when generating rule titles. The font must be available on the server</p></li>
<li><p><strong>fontStyle (string)</strong> can be set to italic or bold to control the text style. Other combinations are not allowed right now but we could implement that as well.</p></li>
<li><p><strong>fontSize (integer)</strong> allows us to set the Font size for the various text elements. Notice that default size is 12.</p></li>
<li><p><strong>fontColor (hex)</strong> allows us to set the color for the text of rules and labels (see above for recommendation on how to create values). Values are expressed in <code class="docutils literal notranslate"><span class="pre">0xRRGGBB</span></code> format</p></li>
<li><p><strong>fontAntiAliasing (true/false)</strong> when true enables antialiasing for rule titles</p></li>
<li><p><strong>bgColor (hex)</strong> background color for the generated legend, values are expressed in <code class="docutils literal notranslate"><span class="pre">0xRRGGBB</span></code> format</p></li>
<li><p><strong>dpi (integer)</strong> sets the DPI for the current request, in the same way as it is supported by GetMap. Setting a DPI larger than 91 (the default) makes all fonts, symbols and line widths grow without changing the current scale, making it possible to get a high resolution version of the legend suitable for inclusion in printouts</p></li>
<li><p><strong>forceLabels</strong> “on” means labels will always be drawn, even if only one rule is available. “off” means labels will never be drawn, even if multiple rules are available. Off by default.</p></li>
<li><p><strong>forceTitles</strong> “off” means layer titles will not be drawn for layer groups. On by default.</p></li>
<li><p><strong>labelMargin</strong> margin (in pixels) to use between icons and labels.</p></li>
<li><p><strong>layout</strong> sets icons layout to be <strong>vertical</strong> (default) or <strong>horizontal</strong>.</p></li>
<li><p><strong>columnheight</strong> enables <strong>multicolumn</strong> layout when layout is <strong>vertical</strong>. Each column height is limited by the columnheight value (in pixels).</p></li>
<li><p><strong>rowwidth</strong> enables <strong>multirow</strong> layout when layout is <strong>horizontal</strong>. Each row width is limited by the rowwidth value (in pixels).</p></li>
<li><p><strong>columns</strong> enables <strong>multicolumn</strong> layout when layout is <strong>vertical</strong>. The value is the maximum columns number of legend. The rows used are equal to the next greater integer of &lt;total of icons&gt;/&lt;number of columns&gt;.</p></li>
<li><p><strong>rows</strong> enables <strong>multirow</strong> layout when layout is <strong>horizontal</strong>. The value is the maximum rows number of legend. The columns used are equal to the next greater integer of &lt;total of icons&gt;/&lt;number of rows&gt;.</p></li>
<li><p><strong>grouplayout</strong> Orientation of groups of layer, possible values are <strong>horizontal</strong> and <strong>vertical</strong> (default if not specified).</p></li>
<li><p><strong>countMatched</strong> When set to true, adds at the end of each label the number of features matching that rule in the current map. Requires extra parameters, see details in the <a class="reference internal" href="#content-dependent"><span class="std std-ref">dedicated section</span></a>.</p></li>
<li><p><strong>hideEmptyRules</strong> When set to true hides rules that are not matching any feature.</p></li>
<li><p><strong>wrap</strong> When set to true word wraps long legend labels, leading to taller legends but less wide ones.</p></li>
</ul>
</div></blockquote>
<p>Here is a sample request sporting most the options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=20&amp;HEIGHT=20&amp;LAYER=topp:states&amp;legend_options=fontName:Times%20New%20Roman;fontAntiAliasing:true;fontColor:0x000033;fontSize:14;bgColor:0xFFFFEE;dpi:180
</pre></div>
</div>
<div class="figure align-center" id="id2">
<img alt="../../../images/legendoptions.png" src="../../../images/legendoptions.png" />
<p class="caption"><span class="caption-text"><em>Using LEGEND_OPTIONS to control the output</em></span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="controlling-legend-layout">
<h2>Controlling legend layout<a class="headerlink" href="#controlling-legend-layout" title="Permalink to this headline">¶</a></h2>
<p>A set of LEGEND_OPTIONS keys are used to control icons layout in the produced legend images. In particular, a <strong>vertical</strong> or <strong>horizontal</strong> layout can be chosen.</p>
<p>Multi column or multi row layouts are possible, and are controlled by the columnheight / rowwidth options (to limit each column / row size) or by the columns / rows options (to fix the # of columns / rows to be used).</p>
<p>Both columnheight / columns and rowwidth / rows can be used to limit the whole size of the produced image (some icons are skipped if they do not fit into the given limits).</p>
<p>In addition, orientation of legends in a layergroup can be configured using the grouplayout option.</p>
</div>
<div class="section" id="raster-legends-explained">
<h2>Raster Legends Explained<a class="headerlink" href="#raster-legends-explained" title="Permalink to this headline">¶</a></h2>
<p>This chapter aims to briefly describe the work that I have performed in order to support legends for raster data that draw information taken from the various bits of the SLD 1.0 RasterSymbolizer element. Recall, that up to now there was no way to create legends for raster data, therefore we have tried to fill the gap by providing an implementation of the getLegendGraphic request that would work with the ColorMap element of the SLD 1.0 RasterSymbolizer. Notice that some “debug” info about the style, like colormap type and band used are printed out as well.</p>
<div class="section" id="what-s-a-raster-legend">
<h3>What’s a raster legend<a class="headerlink" href="#what-s-a-raster-legend" title="Permalink to this headline">¶</a></h3>
<p>Here below I have drawn the structure of a typical legend, where some elements of interests are parameterized.</p>
<div class="figure align-center" id="id3">
<img alt="../../../images/rasterlegend1.png" src="../../../images/rasterlegend1.png" />
<p class="caption"><span class="caption-text"><em>The structure of a typical legend</em></span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>Take as an instance one of the SLD files attached to this page, each row in the above table draws its essence from the  ColorMapEntry element as shown here below:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;ColorMapEntry</span> <span class="na">color=</span><span class="s">&quot;#732600&quot;</span> <span class="na">quantity=</span><span class="s">&quot;9888&quot;</span> <span class="na">opacity=</span><span class="s">&quot;1.0&quot;</span> <span class="na">label=</span><span class="s">&quot;&lt;-70 mm&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>The producer for the raster legend will make use of this elements in order to build the legend, with this in mind, notice that:</p>
<blockquote>
<div><ul class="simple">
<li><p>the width of the Color element is driven by the requested width for the GetLegendGraphic request</p></li>
<li><p>the width and height of label and rules is computed accordingly to the used Font and Font size for the prepared text (<strong>no new line management for the moment</strong>)</p></li>
<li><p>the height of the Color element is driven by the requested width for the GetLegendGraphic request, but notice that for ramps we expand this a little since the goal is to turn the various Color elements into a single long strip</p></li>
<li><p>the height of each row is set to the maximum height of the single elements</p></li>
<li><p>the width of each row is set to the sum of the width of the various elements plus the various paddings</p></li>
<li><p><strong>dx,dy</strong> the spaces between elements and rows are set to the 15% of the requested width and height. Notice that <strong>dy</strong> is ignored for the colormaps of type <strong>ramp</strong> since they must create a continuous color strip.</p></li>
<li><p><strong>absoluteMargins</strong> true/false, used to change the Unit of Measure of <strong>dx</strong> from percentage (when false) to a fixed number of pixels (when true).</p></li>
<li><p><strong>mx,my</strong> the margins from the border of the legends are set to the 1.5% of the total size of the legend</p></li>
</ul>
</div></blockquote>
<p>In conclusion, here below I am adding an image of a sample legend with all the various options at work. The request that generated it is the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8081/geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=100&amp;HEIGHT=20&amp;LAYER=it.geosolutions:di08031_da&amp;LEGEND_OPTIONS=forceRule:True;dx:0.2;dy:0.2;mx:0.2;my:0.2;fontStyle:bold;borderColor:0000ff;border:true;fontColor:ff0000;fontSize:18
</pre></div>
</div>
<p>Do not worry if it seems like something written in ancient dead language, I am going to explain the various params here below.</p>
<div class="figure align-center" id="id4">
<img alt="../../../images/rasterlegend2.png" src="../../../images/rasterlegend2.png" />
<p class="caption"><span class="caption-text"><em>Example of a raster legend</em></span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="raster-legends-types">
<h3>Raster legends’ types<a class="headerlink" href="#raster-legends-types" title="Permalink to this headline">¶</a></h3>
<p>As you may know (well, actually you might not since I never wrote any real docs about the RasterSymbolizer work I did) GeoServer supports three types of ColorMaps:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>ramp</strong> this is what SLD 1.0 dictates, which means a linear interpolation weighted on values between the colors of the various ColorMapEntries.</p></li>
<li><p><strong>values</strong> this is an extension that allows link quantities to colors as specified by the ColorMapEntries quantities. Values not specified are translated into transparent pixels.</p></li>
<li><p><strong>classes</strong> this is an extension that allows pure classifications based on intervals created from the ColorMapEntries quantities. Values not specified are translated into transparent pixels.</p></li>
</ul>
</div></blockquote>
<p>Here below I am going to list various examples that use the attached styles on a rainfall floating point geotiff.</p>
</div>
<div class="section" id="colormap-type-is-values">
<h3>ColorMap type is VALUES<a class="headerlink" href="#colormap-type-is-values" title="Permalink to this headline">¶</a></h3>
<p>Refer to the SLD rainfall.sld in attachment.</p>
<div class="figure align-center" id="id5">
<img alt="../../../images/rasterlegend3.png" src="../../../images/rasterlegend3.png" />
<p class="caption"><span class="caption-text"><em>Raster legend - VALUES type</em></span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="colormap-type-is-classes">
<h3>ColorMap type is CLASSES<a class="headerlink" href="#colormap-type-is-classes" title="Permalink to this headline">¶</a></h3>
<p>Refer to the SLD rainfall_classes.sld in attachment.</p>
<div class="figure align-center" id="id6">
<img alt="../../../images/rasterlegend4.png" src="../../../images/rasterlegend4.png" />
<p class="caption"><span class="caption-text"><em>Raster legend - CLASSES type</em></span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="colormap-type-is-ramp">
<h3>ColorMap type is RAMP<a class="headerlink" href="#colormap-type-is-ramp" title="Permalink to this headline">¶</a></h3>
<p>Refer to the SLD rainfall_classes.sld in attachment. Notice that the first legend shows the default border behavior while the second has been forced to draw a border for the breakpoint color of the colormap entry quantity described by the rendered text. Notice that each color element has a part that show the fixed color from the colormap entry it depicts (the lowest part of it, the one that has been outlined by the border in the second legend below) while the upper part of the element has a gradient that connects each element to the previous one to point out the fact that we are using linear interpolation.</p>
<div class="figure align-center" id="id7">
<img alt="../../../images/rasterlegend5.png" src="../../../images/rasterlegend5.png" />
<p class="caption"><span class="caption-text"><em>Raster legend - RAMP type</em></span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="the-various-control-parameters-and-how-to-set-them">
<h3>The various control parameters and how to set them<a class="headerlink" href="#the-various-control-parameters-and-how-to-set-them" title="Permalink to this headline">¶</a></h3>
<p>I am now going to briefly explain the various parameters that we can use to control the layout and content of the legend. A request that puts all the various options is shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8081/geoserver/wms?REQUEST=GetLegendGraphic&amp;VERSION=1.0.0&amp;FORMAT=image/png&amp;WIDTH=100&amp;HEIGHT=20&amp;LAYER=it.geosolutions:di08031_da&amp;LEGEND_OPTIONS=forceRule:True;dx:0.2;dy:0.2;mx:0.2;my:0.2;fontStyle:bold;borderColor:0000ff;border:true;fontColor:ff0000;fontSize:18
</pre></div>
</div>
<p>Let’s now examine all the interesting elements, one by one. Notice that I am not going to discuss the mechanics of the  GetLegendGraphic operation, for that you may want to refer to the SLD 1.0 spec, my goal is to briefly discuss the LEGEND_OPTIONS parameter.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>forceRule (boolean)</strong> by default rules for a ColorMapEntry are not drawn to keep the legend small and compact, unless there are no labels at all. You can change this behaviour by setting this parameter to true.</p></li>
<li><p><strong>dx,dy,mx,my (double)</strong> can be used to set the margin and the buffers between elements</p></li>
<li><p><strong>border (boolean)</strong> activates or deactivates the border on the color elements in order to make the separations clearer. Notice that I decided to <strong>always</strong> have a line that would split the various color elements for the ramp type of colormap.</p></li>
<li><p><strong>borderColor (hex)</strong> allows us to set the color for the border in 0xRRGGBB format</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="cql-expressions-and-env">
<h3>CQL Expressions and ENV<a class="headerlink" href="#cql-expressions-and-env" title="Permalink to this headline">¶</a></h3>
<p>If CQL expressions are used in ColorMapEntry attributes (see <a class="reference internal" href="../../../styling/sld/reference/rastersymbolizer.html#sld-reference-rastersymbolizer-colormap-cql"><span class="std std-ref">here</span></a>) to create a dynamic color map taking values from ENV, the same ENV parameters used for GetMap can be given to GetLegendGraphic to get the desired legend entries.</p>
</div>
<div class="section" id="content-dependent-legends">
<span id="content-dependent"></span><h3>Content dependent legends<a class="headerlink" href="#content-dependent-legends" title="Permalink to this headline">¶</a></h3>
<p>GeoServer allows building content dependent legend, that is, legends whose contents depend on the currently displayed map.
In order to support it the GetLegendGraphic call needs the following extra parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>BBOX</p></li>
<li><p>SRS or CRS (depending on the WMS version, SRS for 1.1.1 and CRS for 1.3.0)</p></li>
<li><p>SRCWIDTH and SRCHEIGHT, the size of the reference map (width and height already have a different meaning in GetLegendGraphic)</p></li>
</ul>
</div></blockquote>
<p>Other parameters can also be added to better match the GetMap request, for example, it is recommended to mirror
filtering vendor parameters such as, for example, CQL_FILTER,FILTER,FEATUREID,TIME,ELEVATION.</p>
<p>Content dependent evaluation is enabled via the following LEGEND_OPTIONS parameters:</p>
<blockquote>
<div><ul class="simple">
<li><p>countMatched: adds the number of features matching the particular rule at the end of the rule label (requires visible labels to work). Applicable only to vector layers.</p></li>
<li><p>hideEmptyRules:  hides rules that are not matching any feature. Applicable only if countMatched is true.</p></li>
</ul>
</div></blockquote>
<p>For example, let’s assume the following layout is added to GeoServer (<code class="docutils literal notranslate"><span class="pre">legend.xml</span></code> to be placed in <code class="docutils literal notranslate"><span class="pre">GEOSERVER_DATA_DIR/layouts</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">layout</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">decoration</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;legend&quot;</span> <span class="n">affinity</span><span class="o">=</span><span class="s2">&quot;top,right&quot;</span> <span class="n">offset</span><span class="o">=</span><span class="s2">&quot;0,0&quot;</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="o">/&gt;</span>
<span class="o">&lt;/</span><span class="n">layout</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This will make a legend appear in the GetMap response. The following preview request uses the layout to embed a legend and activates
feature counting in it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/topp/wms?service=WMS&amp;version=1.1.0&amp;request=GetMap&amp;layers=topp:states&amp;styles=&amp;bbox=-124.73142200000001,24.955967,-66.969849,49.371735&amp;width=768&amp;height=330&amp;srs=EPSG:4326&amp;format=application/openlayers&amp;format_options=layout:legend&amp;legend_options=countMatched:true;fontAntiAliasing:true
</pre></div>
</div>
<p>The result will look as follows:</p>
<div class="figure align-center" id="id8">
<img alt="../../../images/states-all.png" src="../../../images/states-all.png" />
<p class="caption"><span class="caption-text"><em>Embedded legend, full map</em></span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id9">
<img alt="../../../images/states-four.png" src="../../../images/states-four.png" />
<p class="caption"><span class="caption-text"><em>Embedded legend, four states</em></span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id10">
<img alt="../../../images/states-one.png" src="../../../images/states-one.png" />
<p class="caption"><span class="caption-text"><em>Embedded legend, single state</em></span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="id11">
<img alt="../../../images/states-one-hide-empty.png" src="../../../images/states-one-hide-empty.png" />
<p class="caption"><span class="caption-text"><em>Embedded legend, single state, hide empty rules</em></span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p>The same can be achieved using a stand-alone GetLegendGraphic request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/topp/wms?service=WMS&amp;version=1.1.0&amp;request=GetLegendGraphic&amp;width=20&amp;height=20&amp;layer=topp:states&amp;bbox=-124.73142200000001,24.955967,-66.969849,49.371735&amp;srcwidth=768&amp;srcheight=330&amp;srs=EPSG:4326&amp;format=image/png&amp;legend_options=countMatched:true;fontAntiAliasing:true
</pre></div>
</div>
<div class="figure align-center" id="id12">
<img alt="../../../images/legend-all.png" src="../../../images/legend-all.png" />
<p class="caption"><span class="caption-text"><em>Direct legend request</em></span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<p>Or hide the empty rules using a stand-alone GetLegendGraphic request:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8080/geoserver/topp/wms?service=WMS&amp;version=1.1.0&amp;request=GetLegendGraphic&amp;width=20&amp;height=20&amp;layer=topp:states&amp;bbox=-101.0028076171875,31.025390625,-96.7840576171875,32.838134765625&amp;srcwidth=768&amp;srcheight=330&amp;srs=EPSG:4326&amp;format=image/png&amp;legend_options=countMatched:true;fontAntiAliasing:true;hideEmptyRules:true
</pre></div>
</div>
<div class="figure align-center" id="id13">
<img alt="../../../images/legend-not-empty.png" src="../../../images/legend-not-empty.png" />
<p class="caption"><span class="caption-text"><em>Direct legend request</em></span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="json-output-format">
<h2>JSON Output Format<a class="headerlink" href="#json-output-format" title="Permalink to this headline">¶</a></h2>
<p>Since version 2.15.0 it has been possible to use <strong>application/json</strong>
as an output format in GetLegendGraphic requests. This allows a JSON
aware client to receive a JSON representation of the legend graphic to
use for its own rendering requirements.</p>
<p>A simple http request can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:9000/geoserver/wms?service=WMS&amp;version=1.1.0&amp;request=GetLegendGraphic&amp;layer=topp:states&amp;format=application/json
</pre></div>
</div>
<p>Which returns a JSON response:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Legend&quot;</span><span class="o">:</span> <span class="p">[{</span>
  <span class="s2">&quot;layerName&quot;</span><span class="o">:</span> <span class="s2">&quot;states&quot;</span><span class="p">,</span>
  <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;USA Population&quot;</span><span class="p">,</span>
  <span class="s2">&quot;rules&quot;</span><span class="o">:</span>   <span class="p">[</span>
        <span class="p">{</span>
      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;&lt; 2M&quot;</span><span class="p">,</span>
      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;[PERSONS &lt; &#39;2000000&#39;]&quot;</span><span class="p">,</span>
      <span class="s2">&quot;symbolizers&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="s2">&quot;Polygon&quot;</span><span class="o">:</span>       <span class="p">{</span>
        <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#4DFF4D&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;0.7&quot;</span>
      <span class="p">}}]</span>
    <span class="p">},</span>
        <span class="p">{</span>
      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;2M - 4M&quot;</span><span class="p">,</span>
      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;[PERSONS BETWEEN &#39;2000000&#39; AND &#39;4000000&#39;]&quot;</span><span class="p">,</span>
      <span class="s2">&quot;symbolizers&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="s2">&quot;Polygon&quot;</span><span class="o">:</span>       <span class="p">{</span>
        <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#FF4D4D&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;0.7&quot;</span>
      <span class="p">}}]</span>
    <span class="p">},</span>
        <span class="p">{</span>
      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;&gt; 4M&quot;</span><span class="p">,</span>
      <span class="s2">&quot;filter&quot;</span><span class="o">:</span> <span class="s2">&quot;[PERSONS &gt; &#39;4000000&#39;]&quot;</span><span class="p">,</span>
      <span class="s2">&quot;symbolizers&quot;</span><span class="o">:</span> <span class="p">[{</span><span class="s2">&quot;Polygon&quot;</span><span class="o">:</span>       <span class="p">{</span>
        <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#4D4DFF&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;0.7&quot;</span>
      <span class="p">}}]</span>
    <span class="p">},</span>
        <span class="p">{</span>
      <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;Boundary&quot;</span><span class="p">,</span>
      <span class="s2">&quot;symbolizers&quot;</span><span class="o">:</span>       <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;Line&quot;</span><span class="o">:</span>         <span class="p">{</span>
          <span class="s2">&quot;stroke&quot;</span><span class="o">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="s2">&quot;0.2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;stroke-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;stroke-linecap&quot;</span><span class="o">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">,</span>
          <span class="s2">&quot;stroke-linejoin&quot;</span><span class="o">:</span> <span class="s2">&quot;miter&quot;</span>
        <span class="p">}},</span>
        <span class="p">{</span><span class="s2">&quot;Text&quot;</span><span class="o">:</span>         <span class="p">{</span>
          <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;[STATE_ABBR]&quot;</span><span class="p">,</span>
          <span class="s2">&quot;fonts&quot;</span><span class="o">:</span> <span class="p">[</span>          <span class="p">{</span>
            <span class="s2">&quot;font-family&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">],</span>
            <span class="s2">&quot;font-style&quot;</span><span class="o">:</span> <span class="s2">&quot;Normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;font-weight&quot;</span><span class="o">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;font-size&quot;</span><span class="o">:</span> <span class="s2">&quot;14&quot;</span>
          <span class="p">}],</span>
          <span class="s2">&quot;label-placement&quot;</span><span class="o">:</span>           <span class="p">{</span>
            <span class="s2">&quot;x-anchor&quot;</span><span class="o">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;y-anchor&quot;</span><span class="o">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rotation&quot;</span><span class="o">:</span> <span class="s2">&quot;0.0&quot;</span>
          <span class="p">}</span>
        <span class="p">}}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}]}</span>
</pre></div>
</div>
<p>This JSON contains an array of Legends (one for each layer requested) and
each legend contains some metadata about the legend and an array of <code class="docutils literal notranslate"><span class="pre">rule</span></code>
objects for each rule within the feature type of the style. Each <code class="docutils literal notranslate"><span class="pre">rule</span></code>
contains the metadata associated with the rule, any <code class="docutils literal notranslate"><span class="pre">filter</span></code> element and an array
of <code class="docutils literal notranslate"><span class="pre">symbolizer</span></code> objects.</p>
<div class="section" id="filters-and-expressions">
<h3>Filters and Expressions<a class="headerlink" href="#filters-and-expressions" title="Permalink to this headline">¶</a></h3>
<p>Filters are encoded using <a class="reference internal" href="../../../filter/ecql_reference.html#filter-ecql-reference"><span class="std std-ref">ECQL</span></a>, a rule with an
ElseFilter has an element “ElseFilter” set to the value “true”. Expressions are
also encoded in ECQL (wrapped in []) when encountered in the style.</p>
</div>
<div class="section" id="symbolizers">
<h3>Symbolizers<a class="headerlink" href="#symbolizers" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>PointSymbolizer</p>
<p>A point symbolizer will be represented as a series of elements containing
metadata and an array of <code class="docutils literal notranslate"><span class="pre">graphics</span></code> symbols (see <a class="reference internal" href="../../../styling/sld/reference/pointsymbolizer.html#sld-reference-graphic"><span class="std std-ref">here</span></a>) , these can be well known <code class="docutils literal notranslate"><span class="pre">marks</span></code> or
external graphics. The point symbolizer also provides an “URL” element which
allows a client to make a request back to GeoServer to fetch a PNG image of
the point symbol.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Point&quot;</span><span class="o">:</span>     <span class="p">{</span>
    <span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span>
    <span class="s2">&quot;abstract&quot;</span><span class="o">:</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
    <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://localhost:9000/geoserver/kml/icon/capitals?0.0.0=&quot;</span><span class="p">,</span>
    <span class="s2">&quot;size&quot;</span><span class="o">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rotation&quot;</span><span class="o">:</span> <span class="s2">&quot;0.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;graphics&quot;</span><span class="o">:</span> <span class="p">[</span>      <span class="p">{</span>
      <span class="s2">&quot;mark&quot;</span><span class="o">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stroke&quot;</span><span class="o">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stroke-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stroke-linecap&quot;</span><span class="o">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">,</span>
      <span class="s2">&quot;stroke-linejoin&quot;</span><span class="o">:</span> <span class="s2">&quot;miter&quot;</span>
    <span class="p">}]}}</span>
</pre></div>
</div>
</li>
<li><p>LineSymbolizer</p>
<p>A line symbolizer is represented as a list of metadata elements and the <a class="reference internal" href="../../../styling/sld/reference/linesymbolizer.html#sld-reference-linesymbolizer-css"><span class="std std-ref">stroke
parameters</span></a>, it is possible for there to be a <a class="reference internal" href="../../../styling/sld/reference/linesymbolizer.html#sld-reference-linesymbolizer-graphicstroke"><span class="std std-ref">graphic-stroke</span></a> element too.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Line&quot;</span><span class="o">:</span>     <span class="p">{</span>
  <span class="s2">&quot;stroke&quot;</span><span class="o">:</span> <span class="s2">&quot;#AA3333&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-linecap&quot;</span><span class="o">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-linejoin&quot;</span><span class="o">:</span> <span class="s2">&quot;miter&quot;</span>
<span class="p">}}</span>


<span class="p">{</span><span class="s2">&quot;Line&quot;</span><span class="o">:</span>       <span class="p">{</span>
    <span class="s2">&quot;graphic-stroke&quot;</span><span class="o">:</span>         <span class="p">{</span>
      <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://local-test:8080/geoserver/kml/icon/Default Styler&quot;</span><span class="p">,</span>
      <span class="s2">&quot;size&quot;</span><span class="o">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
      <span class="s2">&quot;opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4&quot;</span><span class="p">,</span>
      <span class="s2">&quot;rotation&quot;</span><span class="o">:</span> <span class="s2">&quot;[(rotation*-1)]&quot;</span><span class="p">,</span>
      <span class="s2">&quot;graphics&quot;</span><span class="o">:</span> <span class="p">[</span>          <span class="p">{</span>
        <span class="s2">&quot;mark&quot;</span><span class="o">:</span> <span class="s2">&quot;square&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#FFFF00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span>
      <span class="p">}]</span>
    <span class="p">},</span>
    <span class="s2">&quot;stroke-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stroke-linecap&quot;</span><span class="o">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;stroke-linejoin&quot;</span><span class="o">:</span> <span class="s2">&quot;miter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;perpendicular-offset&quot;</span><span class="o">:</span> <span class="s2">&quot;10&quot;</span>
  <span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>PolygonSymbolizer</p>
<p>A polygon symbolizer contains <a class="reference internal" href="../../../styling/sld/reference/linesymbolizer.html#sld-reference-linesymbolizer-css"><span class="std std-ref">stroke
parameters</span></a> and <a class="reference internal" href="../../../styling/sld/reference/polygonsymbolizer.html#sld-reference-fill"><span class="std std-ref">fill
parameters</span></a>.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Polygon&quot;</span><span class="o">:</span>       <span class="p">{</span>
  <span class="s2">&quot;stroke&quot;</span><span class="o">:</span> <span class="s2">&quot;#000000&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-width&quot;</span><span class="o">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-linecap&quot;</span><span class="o">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-linejoin&quot;</span><span class="o">:</span> <span class="s2">&quot;miter&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#0099CC&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}}</span>
</pre></div>
</div>
<p>Or a graphic stroke and/or a graphic fill (as described above).</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Polygon&quot;</span><span class="o">:</span>       <span class="p">{</span>
  <span class="s2">&quot;graphic-stroke&quot;</span><span class="o">:</span>         <span class="p">{</span>
    <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://local-test:8080/geoserver/kml/icon/Default Styler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;size&quot;</span><span class="o">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rotation&quot;</span><span class="o">:</span> <span class="s2">&quot;[(rotation*-1)]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;graphics&quot;</span><span class="o">:</span> <span class="p">[</span>          <span class="p">{</span>
      <span class="s2">&quot;mark&quot;</span><span class="o">:</span> <span class="s2">&quot;square&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#FFFF00&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="p">}]</span>
  <span class="p">},</span>
  <span class="s2">&quot;stroke-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-linecap&quot;</span><span class="o">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;stroke-linejoin&quot;</span><span class="o">:</span> <span class="s2">&quot;miter&quot;</span><span class="p">,</span>
  <span class="s2">&quot;graphic-fill&quot;</span><span class="o">:</span>         <span class="p">{</span>
    <span class="s2">&quot;url&quot;</span><span class="o">:</span> <span class="s2">&quot;http://local-test:8080/geoserver/kml/icon/Default Styler&quot;</span><span class="p">,</span>
    <span class="s2">&quot;size&quot;</span><span class="o">:</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;0.4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;rotation&quot;</span><span class="o">:</span> <span class="s2">&quot;[(rotation*-1)]&quot;</span><span class="p">,</span>
    <span class="s2">&quot;graphics&quot;</span><span class="o">:</span> <span class="p">[</span>          <span class="p">{</span>
      <span class="s2">&quot;mark&quot;</span><span class="o">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fill&quot;</span><span class="o">:</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">,</span>
      <span class="s2">&quot;fill-opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span>
    <span class="p">}]</span>
  <span class="p">}}}</span>
</pre></div>
</div>
</li>
<li><p>RasterSymbolizer</p>
<p>Raster symbolizers contain a <code class="docutils literal notranslate"><span class="pre">colormap</span></code> with an array of <code class="docutils literal notranslate"><span class="pre">entries</span></code>, each entry
contains a <code class="docutils literal notranslate"><span class="pre">label</span></code>, <code class="docutils literal notranslate"><span class="pre">quantity</span></code> and <code class="docutils literal notranslate"><span class="pre">color</span></code> element.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Raster&quot;</span><span class="o">:</span>   <span class="p">{</span>
  <span class="s2">&quot;colormap&quot;</span><span class="o">:</span>     <span class="p">{</span>
    <span class="s2">&quot;entries&quot;</span><span class="o">:</span>       <span class="p">[</span>
              <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;#AAFFAA&quot;</span>
      <span class="p">},</span>
              <span class="p">{</span>
        <span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="s2">&quot;1000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;#00FF00&quot;</span>
      <span class="p">},</span>
              <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="s2">&quot;1200&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;#FFFF00&quot;</span>
      <span class="p">},</span>
              <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="s2">&quot;1400&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;#FF7F00&quot;</span>
      <span class="p">},</span>
              <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="s2">&quot;1600&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;#BF7F3F&quot;</span>
      <span class="p">},</span>
              <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;values&quot;</span><span class="p">,</span>
        <span class="s2">&quot;quantity&quot;</span><span class="o">:</span> <span class="s2">&quot;2000&quot;</span><span class="p">,</span>
        <span class="s2">&quot;color&quot;</span><span class="o">:</span> <span class="s2">&quot;#000000&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;ramp&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;opacity&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}}</span>
</pre></div>
</div>
</li>
<li><p>TextSymbolizer</p>
<p>A text symbolizer contains a <code class="docutils literal notranslate"><span class="pre">label</span></code> expression, followed by an array of <code class="docutils literal notranslate"><span class="pre">fonts</span></code>
and a <code class="docutils literal notranslate"><span class="pre">label-placement</span></code> object containing details of how the label is
placed.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;Text&quot;</span><span class="o">:</span>         <span class="p">{</span>
        <span class="s2">&quot;label&quot;</span><span class="o">:</span> <span class="s2">&quot;[STATE_ABBR]&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fonts&quot;</span><span class="o">:</span> <span class="p">[</span>          <span class="p">{</span>
                <span class="s2">&quot;font-family&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">],</span>
                <span class="s2">&quot;font-style&quot;</span><span class="o">:</span> <span class="s2">&quot;Normal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;font-weight&quot;</span><span class="o">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;font-size&quot;</span><span class="o">:</span> <span class="s2">&quot;14&quot;</span>
        <span class="p">}],</span>
        <span class="s2">&quot;label-placement&quot;</span><span class="o">:</span>           <span class="p">{</span>
                <span class="s2">&quot;x-anchor&quot;</span><span class="o">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;y-anchor&quot;</span><span class="o">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>
                <span class="s2">&quot;rotation&quot;</span><span class="o">:</span> <span class="s2">&quot;0.0&quot;</span>
        <span class="p">}</span>
<span class="p">}}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="vendor-options">
<h3>Vendor Options<a class="headerlink" href="#vendor-options" title="Permalink to this headline">¶</a></h3>
<p>In any case where one or more vendor options is included in the symbolizer there
will be a <code class="docutils literal notranslate"><span class="pre">vendor-options</span></code> element included in the output. This object will
include one line for each vendor option.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;vendor-options&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;labelAllGroup&quot;</span><span class="o">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
  <span class="s2">&quot;spaceAround&quot;</span><span class="o">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span>
  <span class="s2">&quot;followLine&quot;</span><span class="o">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
  <span class="s2">&quot;autoWrap&quot;</span><span class="o">:</span> <span class="s2">&quot;50&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="../global.html" title="previous chapter">Global variables affecting WMS</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="../decoration.html" title="next chapter">WMS Decorations</a></div>
      </div>
      </div><!-- /#content> -->
      <div id="content-right" class="content-border"></div>
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">GetLegendGraphic</a><ul>
<li><a class="reference internal" href="#controlling-legend-appearance-with-legend-options">Controlling legend appearance with LEGEND_OPTIONS</a></li>
<li><a class="reference internal" href="#controlling-legend-layout">Controlling legend layout</a></li>
<li><a class="reference internal" href="#raster-legends-explained">Raster Legends Explained</a><ul>
<li><a class="reference internal" href="#what-s-a-raster-legend">What’s a raster legend</a></li>
<li><a class="reference internal" href="#raster-legends-types">Raster legends’ types</a></li>
<li><a class="reference internal" href="#colormap-type-is-values">ColorMap type is VALUES</a></li>
<li><a class="reference internal" href="#colormap-type-is-classes">ColorMap type is CLASSES</a></li>
<li><a class="reference internal" href="#colormap-type-is-ramp">ColorMap type is RAMP</a></li>
<li><a class="reference internal" href="#the-various-control-parameters-and-how-to-set-them">The various control parameters and how to set them</a></li>
<li><a class="reference internal" href="#cql-expressions-and-env">CQL Expressions and ENV</a></li>
<li><a class="reference internal" href="#content-dependent-legends">Content dependent legends</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-output-format">JSON Output Format</a><ul>
<li><a class="reference internal" href="#filters-and-expressions">Filters and Expressions</a></li>
<li><a class="reference internal" href="#symbolizers">Symbolizers</a></li>
<li><a class="reference internal" href="#vendor-options">Vendor Options</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="../global.html" title="previous chapter">Global variables affecting WMS</a></li>
            <li>Next: <a href="../decoration.html" title="next chapter">WMS Decorations</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
                
        <li><a href="https://github.com/geoserver/geoserver/tree/master/doc/en/user/source/services/wms/get_legend_graphic/index.rst">Edit</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2021, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Jul 20, 2021.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>