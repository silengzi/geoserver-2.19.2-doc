<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Role services &mdash; GeoServer 2.19.2 User Manual</title>
  <link rel="stylesheet" href="../../static/blueprint/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../../static/blueprint/print.css" type="text/css" media="print" /> 
  <!--[if IE]>
  <link rel="stylesheet" href="../../static/blueprint/ie.css" type="text/css" media="screen, projection" />
  <![endif]-->
  <link rel="stylesheet" href="../../static/default.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.19.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="../../static/jquery.js"></script>
  <script type="text/javascript" src="../../static/doctools.js"></script>
  <script type="text/javascript" src="../../static/searchtools.js"></script>
  <script type="text/javascript" src="../../searchindex.js"></script>
  <link rel="shortcut icon" href="../../static/geoserver.ico"/>
      <link rel="search" title="Search" href="../../search.html" />
      <link rel="top" title="GeoServer 2.19.2 User Manual" href="../../index.html" />
      <link rel="up" title="Role system" href="index.html" />
      <link rel="next" title="Role source and role calculation" href="rolesource.html" />
      <link rel="prev" title="Roles" href="roles.html" />
</head>
<body class="security/usergrouprole/roleservices">
  <div id="header" class="selfclear">
    <div class="wrap selfclear">
      <div id="logo"><a href="../../index.html">GeoServer 2.19.2 User Manual</a></div>
      <ul id="top-nav">
        <li class="first"><a href="http://geoserver.org/about">About</a></li>
        <li><a href="http://blog.geoserver.org/">Blog</a></li>
        <li><a href="http://geoserver.org/download">Download</a></li>
        <!--<li><a href="../../index.html">Documentation</a></li>-->
      </ul>
        <form id="quick-search" action="../../search.html" method="get">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
            <input id="quick-search-submit" type="image" value="Search" src="../../static/chrome/search_icon_green.png" />
          </fieldset>
        </form>
    </div><!-- /.wrap -->
  </div><!-- /#header -->
  <div id="main">
    <div class="wrap selfclear">
      <div id="content-left" class="content-border"></div>
      <div id="content">
<ul id="breadcrumbs">
  
  <li><a href="../../index.html">GeoServer 2.19.2 User Manual</a> &raquo;</li>
  <li><a href="../index.html" accesskey="U">Security</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Role system</a> &raquo;</li>
  <li>Role services</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../../py-modindex.html" title="Python Module Index"
       accesskey="">modules</a></li>
  <li>
    <a href="rolesource.html" title="Role source and role calculation"
       accesskey="N">next</a>|</li>
  <li>
    <a href="roles.html" title="Roles"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="role-services">
<span id="security-rolesystem-roleservices"></span><h1>Role services<a class="headerlink" href="#role-services" title="Permalink to this headline">¶</a></h1>
<p>A <strong>role service</strong> provides the following information for roles:</p>
<ul class="simple">
<li><p>List of roles</p></li>
<li><p>Calculation of role assignments for a given user</p></li>
<li><p>Mapping of a role to the system role <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code></p></li>
<li><p>Mapping of a role to the system role <code class="docutils literal notranslate"><span class="pre">ROLE_GROUP_ADMIN</span></code></p></li>
</ul>
<p>When a user/group service loads information about a user or a group, it delegates to the role service to determine which roles should be assigned to the user or group.  Unlike <a class="reference internal" href="usergroupservices.html#security-rolesystem-usergroupservices"><span class="std std-ref">User/group services</span></a>, only one role service is active at any given time.</p>
<p>By default, GeoServer supports two types of role services:</p>
<ul class="simple">
<li><p>XML—<em>(Default)</em> role service persisted as XML</p></li>
<li><p>JDBC—Role service persisted in a database via JDBC</p></li>
</ul>
<div class="section" id="mapping-roles-to-system-roles">
<span id="security-rolesystem-mapping"></span><h2>Mapping roles to system roles<a class="headerlink" href="#mapping-roles-to-system-roles" title="Permalink to this headline">¶</a></h2>
<p>To assign the system role <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code> to a user or to a group, a new role with a different name must be created and mapped to the <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code> role. The same holds true for the system role <code class="docutils literal notranslate"><span class="pre">ROLE_GROUP_ADMIN</span></code>. The mapping is stored in the service’s <code class="docutils literal notranslate"><span class="pre">config.xml</span></code> file.</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;roleService&gt;</span>
  <span class="nt">&lt;id&gt;</span>471ed59f:13915c479bc:-7ffc<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;name&gt;</span>default<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;className&gt;</span>org.geoserver.security.xml.XMLRoleService<span class="nt">&lt;/className&gt;</span>
  <span class="nt">&lt;fileName&gt;</span>roles.xml<span class="nt">&lt;/fileName&gt;</span>
  <span class="nt">&lt;checkInterval&gt;</span>10000<span class="nt">&lt;/checkInterval&gt;</span>
  <span class="nt">&lt;validating&gt;</span>true<span class="nt">&lt;/validating&gt;</span>
  <span class="nt">&lt;adminRoleName&gt;</span>ADMIN<span class="nt">&lt;/adminRoleName&gt;</span>
  <span class="nt">&lt;groupAdminRoleName&gt;</span>GROUP_ADMIN<span class="nt">&lt;/groupAdminRoleName&gt;</span>
<span class="nt">&lt;/roleService&gt;</span>
</pre></div>
</div>
<p>In this example, a user or a group assigned to the role <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code> is also assigned to the system role <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code>. The same holds true for <code class="docutils literal notranslate"><span class="pre">GROUP_ADMIN</span></code> and <code class="docutils literal notranslate"><span class="pre">ROLE_GROUP_ADMIN</span></code>.</p>
</div>
<div class="section" id="xml-role-service">
<span id="security-rolesystem-rolexml"></span><h2>XML role service<a class="headerlink" href="#xml-role-service" title="Permalink to this headline">¶</a></h2>
<p>The XML role service persists the role database in an XML file. This is the default role service for GeoServer.
This service represents the user database as XML, and corresponds to this <a class="reference download internal" download="" href="../../downloads/03e998357d6ef84856d5ce56774f31e8/roles.xsd"><code class="xref download docutils literal notranslate"><span class="pre">XML</span> <span class="pre">schema</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The XML role file, <code class="file docutils literal notranslate"><span class="pre">roles.xml</span></code>, is located in  the GeoServer data directory, <code class="docutils literal notranslate"><span class="pre">security/role/&lt;name&gt;/roles.xml</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> is the name of the role service.</p>
</div>
<p>The service is configured to map the local role <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code> to the system role <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code>. Additionally, <code class="docutils literal notranslate"><span class="pre">GROUP_ADMIN</span></code> is mapped to <code class="docutils literal notranslate"><span class="pre">ROLE_GROUP_ADMIN</span></code>. The mapping is stored the <code class="docutils literal notranslate"><span class="pre">config.xml</span></code> file of each role service.</p>
<p>The following provides an illustration of the <code class="docutils literal notranslate"><span class="pre">roles.xml</span></code> that ships with the default GeoServer configuration:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;roleRegistry</span> <span class="na">version=</span><span class="s">&quot;1.0&quot;</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.geoserver.org/security/roles&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;roleList&gt;</span>
    <span class="nt">&lt;role</span> <span class="na">id=</span><span class="s">&quot;ADMIN&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;role</span> <span class="na">id=</span><span class="s">&quot;GROUP_ADMIN&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/roleList&gt;</span>
  <span class="nt">&lt;userList&gt;</span>
    <span class="nt">&lt;userRoles</span> <span class="na">username=</span><span class="s">&quot;admin&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;roleRef</span> <span class="na">roleID=</span><span class="s">&quot;ADMIN&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/userRoles&gt;</span>
  <span class="nt">&lt;/userList&gt;</span>
  <span class="nt">&lt;groupList/&gt;</span>
<span class="nt">&lt;/roleRegistry&gt;</span>
</pre></div>
</div>
<p>This configuration contains two roles named <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code> and <code class="docutils literal notranslate"><span class="pre">GROUP_ADMIN</span></code>. The role <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code> is assigned to the <code class="docutils literal notranslate"><span class="pre">admin</span></code> user. Since the <code class="docutils literal notranslate"><span class="pre">ADMIN</span></code> role is mapped to the system role <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code>, the role calculation assigns both roles to the <code class="docutils literal notranslate"><span class="pre">admin</span></code> user.</p>
<p>For further information, please refer to <a class="reference internal" href="../webadmin/ugr.html#security-webadmin-roleservices"><span class="std std-ref">configuring a role service</span></a> in the <a class="reference internal" href="../../webadmin/index.html#web-admin"><span class="std std-ref">Web administration interface</span></a>.</p>
</div>
<div class="section" id="j2ee-role-service">
<span id="security-rolesystem-rolej2ee"></span><h2>J2EE role service<a class="headerlink" href="#j2ee-role-service" title="Permalink to this headline">¶</a></h2>
<p>The J2EE role service parses roles from the <code class="docutils literal notranslate"><span class="pre">WEB-INF/web.xml</span></code> file. As a consequence, this service is a read only role service.
Roles are extracted from the following XML elements:</p>
<div class="section" id="security-role">
<h3><code class="docutils literal notranslate"><span class="pre">&lt;security-role&gt;</span></code><a class="headerlink" href="#security-role" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;security-role&gt;</span>
   <span class="nt">&lt;role-name&gt;</span>role1<span class="nt">&lt;/role-name&gt;</span>
<span class="nt">&lt;/security-role&gt;</span>
<span class="nt">&lt;security-role&gt;</span>
   <span class="nt">&lt;role-name&gt;</span>role2<span class="nt">&lt;/role-name&gt;</span>
<span class="nt">&lt;/security-role&gt;</span>
<span class="nt">&lt;security-role&gt;</span>
   <span class="nt">&lt;role-name&gt;</span>employee<span class="nt">&lt;/role-name&gt;</span>
<span class="nt">&lt;/security-role&gt;</span>
</pre></div>
</div>
<p>Roles retrieved:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">role1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">role2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">employee</span></code></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="security-constraint">
<h3><code class="docutils literal notranslate"><span class="pre">&lt;security-constraint&gt;</span></code><a class="headerlink" href="#security-constraint" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span> <span class="nt">&lt;security-constraint&gt;</span>
    <span class="nt">&lt;web-resource-collection&gt;</span>
        <span class="nt">&lt;web-resource-name&gt;</span>Protected Area<span class="nt">&lt;/web-resource-name&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>/jsp/security/protected/*<span class="nt">&lt;/url-pattern&gt;</span>
        <span class="nt">&lt;http-method&gt;</span>PUT<span class="nt">&lt;/http-method&gt;</span>
        <span class="nt">&lt;http-method&gt;</span>DELETE<span class="nt">&lt;/http-method&gt;</span>
        <span class="nt">&lt;http-method&gt;</span>GET<span class="nt">&lt;/http-method&gt;</span>
        <span class="nt">&lt;http-method&gt;</span>POST<span class="nt">&lt;/http-method&gt;</span>
    <span class="nt">&lt;/web-resource-collection&gt;</span>
    <span class="nt">&lt;auth-constraint&gt;</span>
        <span class="nt">&lt;role-name&gt;</span>role1<span class="nt">&lt;/role-name&gt;</span>
        <span class="nt">&lt;role-name&gt;</span>employee<span class="nt">&lt;/role-name&gt;</span>
    <span class="nt">&lt;/auth-constraint&gt;</span>
<span class="nt">&lt;/security-constraint&gt;</span>
</pre></div>
</div>
<p>Roles retrieved:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">role1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">employee</span></code></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="security-role-ref">
<h3><code class="docutils literal notranslate"><span class="pre">&lt;security-role-ref&gt;</span></code><a class="headerlink" href="#security-role-ref" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;security-role-ref&gt;</span>
    <span class="nt">&lt;role-name&gt;</span>MGR<span class="nt">&lt;/role-name&gt;</span>
    <span class="c">&lt;!-- role name used in code --&gt;</span>
    <span class="nt">&lt;role-link&gt;</span>employee<span class="nt">&lt;/role-link&gt;</span>
  <span class="nt">&lt;/security-role-ref&gt;</span>
</pre></div>
</div>
<p>Roles retrieved:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MGR</span></code></p></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="jdbc-role-service">
<span id="security-rolesystem-rolejdbc"></span><h2>JDBC role service<a class="headerlink" href="#jdbc-role-service" title="Permalink to this headline">¶</a></h2>
<p>The JDBC role service persists the role database via JDBC, managing the role information in multiple tables. The role database schema is as follows:</p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-text">Table: roles</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Null</p></th>
<th class="head"><p>Key</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>varchar(64)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
<tr class="row-odd"><td><p>parent</p></td>
<td><p>varchar(64)</p></td>
<td><p>YES</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id2">
<caption><span class="caption-text">Table: role_props</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Null</p></th>
<th class="head"><p>Key</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rolename</p></td>
<td><p>varchar(64)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
<tr class="row-odd"><td><p>propname</p></td>
<td><p>varchar(64)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
<tr class="row-even"><td><p>propvalue</p></td>
<td><p>varchar(2048)</p></td>
<td><p>YES</p></td>
<td></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id3">
<caption><span class="caption-text">Table: user_roles</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Null</p></th>
<th class="head"><p>Key</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>username</p></td>
<td><p>varchar(128)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
<tr class="row-odd"><td><p>rolename</p></td>
<td><p>varchar(64)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id4">
<caption><span class="caption-text">Table: group_roles</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Null</p></th>
<th class="head"><p>Key</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>groupname</p></td>
<td><p>varchar(128)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
<tr class="row-odd"><td><p>rolename</p></td>
<td><p>varchar(64)</p></td>
<td><p>NO</p></td>
<td><p>PRI</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">roles</span></code> table is the primary table and contains the list of roles.  Roles in GeoServer support inheritance, so a role may optionally have a link to a parent role. The <code class="docutils literal notranslate"><span class="pre">role_props</span></code> table maps additional properties to a role. (See the section on <a class="reference internal" href="roles.html#security-rolesystem-roles"><span class="std std-ref">Roles</span></a> for more details.)  The <code class="docutils literal notranslate"><span class="pre">user_roles</span></code> table maps users to the roles they are assigned.  Similarly the <code class="docutils literal notranslate"><span class="pre">group_roles</span></code> table maps which groups have been assigned to which roles.</p>
<p>The default GeoServer security configuration is:</p>
<table class="colwidths-given docutils align-default" id="id5">
<caption><span class="caption-text">Table: roles</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>parent</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Empty</em></p></td>
<td><p><em>Empty</em></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id6">
<caption><span class="caption-text">Table: role_props</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>rolename</p></th>
<th class="head"><p>propname</p></th>
<th class="head"><p>propvalue</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Empty</em></p></td>
<td><p><em>Empty</em></p></td>
<td><p><em>Empty</em></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id7">
<caption><span class="caption-text">Table: user_roles</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>username</p></th>
<th class="head"><p>rolename</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Empty</em></p></td>
<td><p><em>Empty</em></p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id8">
<caption><span class="caption-text">Table: group_roles</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>groupname</p></th>
<th class="head"><p>rolename</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Empty</em></p></td>
<td><p><em>Empty</em></p></td>
</tr>
</tbody>
</table>
<p>For further information, please refer to <a class="reference internal" href="../webadmin/ugr.html#security-webadmin-roleservices"><span class="std std-ref">configuring a role service</span></a> in the <a class="reference internal" href="../../webadmin/index.html#web-admin"><span class="std std-ref">Web administration interface</span></a>.</p>
</div>
<div class="section" id="ldap-role-service">
<h2>LDAP role service<a class="headerlink" href="#ldap-role-service" title="Permalink to this headline">¶</a></h2>
<p>The LDAP role service is a read only role service that maps groups from an LDAP repository to GeoServer roles.</p>
<p>Groups are extracted from a specific LDAP node, configured as the <code class="docutils literal notranslate"><span class="pre">Groups</span> <span class="pre">search</span> <span class="pre">base</span></code>. A role is mapped for every matching group. The role will have a name that is built taking the Group common name (cn attribute), transformed to upper case and with a <code class="docutils literal notranslate"><span class="pre">ROLE_</span></code> prefix applied.</p>
<p>It is possible to filter extracted groups using an <code class="docutils literal notranslate"><span class="pre">All</span> <span class="pre">groups</span> <span class="pre">filter</span></code> (defaults to <code class="docutils literal notranslate"><span class="pre">cn=*</span></code> that basically extracts all nodes from the configured base). It is also possible to configure the filter for <code class="docutils literal notranslate"><span class="pre">users</span> <span class="pre">to</span> <span class="pre">roles</span> <span class="pre">membership</span></code> (defaults to member={0}).</p>
<p>A specific group can be assigned to the <code class="docutils literal notranslate"><span class="pre">ROLE_ADMINISTRATOR</span></code> and/or the <code class="docutils literal notranslate"><span class="pre">ROLE_GROUP_ADMIN</span></code> administrative roles.</p>
<p>Groups extraction can be done anonymously or using a given username/password if the LDAP repository requires it.</p>
<p>An example of configuration file (config.xml) for this type of role service is the following:</p>
<blockquote>
<div><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;org.geoserver.security.ldap.LDAPRoleServiceConfig&gt;</span>
  <span class="nt">&lt;id&gt;</span>-36dfbd50:1424687f3e0:-8000<span class="nt">&lt;/id&gt;</span>
  <span class="nt">&lt;name&gt;</span>ldapacme<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;className&gt;</span>org.geoserver.security.ldap.LDAPRoleService<span class="nt">&lt;/className&gt;</span>
  <span class="nt">&lt;serverURL&gt;</span>ldap://127.0.0.1:10389/dc=acme,dc=org<span class="nt">&lt;/serverURL&gt;</span>
  <span class="nt">&lt;groupSearchBase&gt;</span>ou=groups<span class="nt">&lt;/groupSearchBase&gt;</span>
  <span class="nt">&lt;groupSearchFilter&gt;</span>member=uid={0},ou=people,dc=acme,dc=org<span class="nt">&lt;/groupSearchFilter&gt;</span>
  <span class="nt">&lt;useTLS&gt;</span>false<span class="nt">&lt;/useTLS&gt;</span>
  <span class="nt">&lt;bindBeforeGroupSearch&gt;</span>true<span class="nt">&lt;/bindBeforeGroupSearch&gt;</span>
  <span class="nt">&lt;adminGroup&gt;</span>ROLE_ADMIN<span class="nt">&lt;/adminGroup&gt;</span>
  <span class="nt">&lt;groupAdminGroup&gt;</span>ROLE_ADMIN<span class="nt">&lt;/groupAdminGroup&gt;</span>
  <span class="nt">&lt;user&gt;</span>uid=bill,ou=people,dc=acme,dc=org<span class="nt">&lt;/user&gt;</span>
  <span class="nt">&lt;password&gt;</span>hello<span class="nt">&lt;/password&gt;</span>
  <span class="nt">&lt;allGroupsSearchFilter&gt;</span>cn=*<span class="nt">&lt;/allGroupsSearchFilter&gt;</span>
<span class="nt">&lt;/org.geoserver.security.ldap.LDAPRoleServiceConfig&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>For further information, please refer to <a class="reference internal" href="../webadmin/ugr.html#security-webadmin-roleservices"><span class="std std-ref">configuring a role service</span></a> in the <a class="reference internal" href="../../webadmin/index.html#web-admin"><span class="std std-ref">Web administration interface</span></a>.</p>
</div>
<div class="section" id="rest-role-service">
<h2>REST role service<a class="headerlink" href="#rest-role-service" title="Permalink to this headline">¶</a></h2>
<p>The REST role service is a read only role service that maps groups and associated users to roles from a remote REST web service.</p>
<p>The REST service <strong>must</strong> support JSON encoding.</p>
<p>Here is a listing of significant methods provided by the REST Role Service (based on the LDAP role service, which similarly has to make network calls to work):</p>
<table class="colwidths-given docutils align-default" id="id9">
<caption><span class="caption-text">Table: roles</span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Mandatory</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>getUserNamesForRole(roleName)</em></p></td>
<td><p>N (implemented in LDAP, but I don’t see actual users of this method besides a utility method that nobody uses)</p></td>
</tr>
<tr class="row-odd"><td><p><em>getRolesForUser(user)</em></p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-even"><td><p><em>getRolesForGroup(group)</em></p></td>
<td><p>N</p></td>
</tr>
<tr class="row-odd"><td><p><em>getRoles()</em></p></td>
<td><p>Y (used by the UI)</p></td>
</tr>
<tr class="row-even"><td><p><em>getParentRole(role)</em></p></td>
<td><p>N</p></td>
</tr>
<tr class="row-odd"><td><p><em>getAdminRole()</em></p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-even"><td><p><em>getGroupAdminRole()</em></p></td>
<td><p>Y</p></td>
</tr>
<tr class="row-odd"><td><p><em>getRoleCount()</em></p></td>
<td><p>Y (does not seem to be used much, we can trivially implement it from getRoles()</p></td>
</tr>
</tbody>
</table>
<div class="section" id="rest-apis">
<h3>REST APIs<a class="headerlink" href="#rest-apis" title="Permalink to this headline">¶</a></h3>
<p>The following is an example of the REST API the role service may handle. The JSON and remote endpoints may differ; this is conifgurable via UI, allowing the REST role service to connect to a generci REST Service</p>
<p>From the above we could have the following REST API to talk to</p>
<p><code class="docutils literal notranslate"><span class="pre">../api/roles</span></code></p>
<p>Returns the full list of roles (no paging required, we assume it’s small). Example response:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;groups&quot;</span><span class="p">:[</span><span class="s2">&quot;r1&quot;</span><span class="p">,</span><span class="s2">&quot;r2&quot;</span><span class="p">,</span><span class="s2">&quot;r3&quot;</span><span class="p">]}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">../api/adminrole</span></code></p>
<p>Returns the role of the administrator (yes, just one, it’s strange…):</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;adminRole&quot;</span><span class="p">:[</span><span class="s2">&quot;root&quot;</span><span class="p">]}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">../api/users/&lt;user&gt;</span></code></p>
<p>Returns the list of roles for a particular user. Example response:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;users&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="nt">&quot;user&quot;</span><span class="p">:</span><span class="s2">&quot;u1&quot;</span><span class="p">,</span> <span class="nt">&quot;groups&quot;</span><span class="p">:[</span><span class="s2">&quot;r1&quot;</span><span class="p">,</span><span class="s2">&quot;r2&quot;</span><span class="p">]}]}</span>
</pre></div>
</div>
</div>
<div class="section" id="configurable-api">
<h3>Configurable API<a class="headerlink" href="#configurable-api" title="Permalink to this headline">¶</a></h3>
<p>The GeoServerRoleService talking to a remote service provides the following config parameters:</p>
<ul class="simple">
<li><p>Base URL for the remote service</p></li>
<li><p>Configurable URLs for the various calls</p></li>
<li><p>JSON paths to the properties that contain the list of roles, and the one admin role</p></li>
</ul>
<p>The above can be configured via the <a class="reference internal" href="../../webadmin/index.html#web-admin"><span class="std std-ref">Web administration interface</span></a>. The figure below shows the REST role service options configured to be compatible with the sampe APIs above:</p>
<div class="figure align-center" id="id10">
<img alt="../../_images/restroleservice.png" src="../../_images/restroleservice.png" />
<p class="caption"><span class="caption-text"><em>REST based role service configuration panel</em></span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="roles.html" title="previous chapter">Roles</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="rolesource.html" title="next chapter">Role source and role calculation</a></div>
      </div>
      </div><!-- /#content> -->
      <div id="content-right" class="content-border"></div>
  <div id="sidebar" class="contrast">
      <div id="toc" class="section">
        <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Role services</a><ul>
<li><a class="reference internal" href="#mapping-roles-to-system-roles">Mapping roles to system roles</a></li>
<li><a class="reference internal" href="#xml-role-service">XML role service</a></li>
<li><a class="reference internal" href="#j2ee-role-service">J2EE role service</a><ul>
<li><a class="reference internal" href="#security-role"><code class="docutils literal notranslate"><span class="pre">&lt;security-role&gt;</span></code></a></li>
<li><a class="reference internal" href="#security-constraint"><code class="docutils literal notranslate"><span class="pre">&lt;security-constraint&gt;</span></code></a></li>
<li><a class="reference internal" href="#security-role-ref"><code class="docutils literal notranslate"><span class="pre">&lt;security-role-ref&gt;</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#jdbc-role-service">JDBC role service</a></li>
<li><a class="reference internal" href="#ldap-role-service">LDAP role service</a></li>
<li><a class="reference internal" href="#rest-role-service">REST role service</a><ul>
<li><a class="reference internal" href="#rest-apis">REST APIs</a></li>
<li><a class="reference internal" href="#configurable-api">Configurable API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="roles.html" title="previous chapter">Roles</a></li>
            <li>Next: <a href="rolesource.html" title="next chapter">Role source and role calculation</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
                
        <li><a href="https://github.com/geoserver/geoserver/tree/master/doc/en/user/source/security/usergrouprole/roleservices.rst">Edit</a></li>
        </ul>
        </div>
  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div><!-- /#main -->
<div id="footer">
  <div class="wrap">
    &copy; Copyright 2021, Open Source Geospatial Foundation. License <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution</a>.
    Last updated on Jul 20, 2021.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div><!-- /.wrap> -->
</div><!-- /#footer -->
  </body>
</html>